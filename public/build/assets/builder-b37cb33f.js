import{_ as D,o as n,f as d,a as e,at as ve,t as k,am as R,an as E,a9 as G,k as q,j as B,x as C,ag as be,l as Z,m as P,v as z,F as A,z as T,N as Y,e as v,b as x,n as M,c as F,I as Q,g as I,p as X,d as H,r as V,w as U,Q as ye,M as xe,au as oe,av as ge,ab as ee,al as L,u as ke,h as Se,y as ce,aw as we,ax as $e,Y as Ce,s as Fe,D as Ue,A as Ae,B as Ie,C as We,E as Me,K as Le,G as je,J as qe,H as De,P as Ve,L as Be}from"./AbilityItem-bfb7c390.js";import{C as J,I as Oe,b as Te,A as Ne,u as le,B as de,c as ue,S as Pe,a as Re,F as Ee}from"./HelpBar-3318f4bf.js";import{u as He}from"./useMustAuthState-ee26b178.js";const ze={props:{label:{type:String,required:!0},modelValue:{type:Boolean,required:!0}}},Ye=t=>(R("data-v-154813cc"),t=t(),E(),t),Ge={class:"toggle-switch"},Je=["checked"],Ke=Ye(()=>e("span",{class:"switch"},null,-1)),Qe={class:"label"};function Xe(t,s,r,i,o,c){return n(),d("label",Ge,[e("input",ve(t.$attrs,{class:"input",type:"checkbox",checked:r.modelValue,onChange:s[0]||(s[0]=m=>t.$emit("update:modelValue",m.target.checked))}),null,16,Je),Ke,e("span",Qe,k(r.label),1)])}const Ze=D(ze,[["render",Xe],["__scopeId","data-v-154813cc"]]);const ne=t=>(R("data-v-9f8a73d4"),t=t(),E(),t),et=["onSubmit"],tt={class:"form-group"},st=ne(()=>e("label",null,"Nickname (optional identifier for your sanity)",-1)),ot=["placeholder"],lt={class:"form-group"},nt=ne(()=>e("label",null,"Chip Level",-1)),it={class:"chips flex gap-x-1"},at=["onClick"],rt={key:0,class:"form-group"},ct=ne(()=>e("label",null,"Visibility",-1)),dt={class:"form-group pt-4 flex gap-x-4 justify-between"},ut=["disabled"],ht={key:0},_t=["disabled"],pt={__name:"UserShipForm",props:{ship:{type:Object,required:!0},userShip:{type:Object,default:null},onSave:{type:Function,required:!0},onDelete:{type:Function,default:null}},setup(t){const s=t,r=G(),i=q(!1),o=B({name:"",chip_level:0,visible:!0}),c=async()=>{var _,h,l;i.value=!0;try{s.onSave({...o,id_ship:s.ship.id_ship,id_user_ship:(_=s.userShip)==null?void 0:_.id_user_ship})}catch(p){r.error(((l=(h=error.response)==null?void 0:h.data)==null?void 0:l.message)||p.message)}i.value=!1},m=async _=>{var h,l;if(!s.onDelete)return!1;i.value=!0;try{s.onDelete(_)}catch(p){r.error(((l=(h=error.response)==null?void 0:h.data)==null?void 0:l.message)||p.message)}i.value=!1},b=()=>{s.userShip?(o.name=s.userShip.name,o.chip_level=s.userShip.chip_level,o.visible=s.userShip.visible):(o.name="",o.chip_level=0,o.visible=!0)},u=C(()=>be(s.ship));return Z(()=>s.userShip,()=>{b()},{immediate:!0}),(_,h)=>(n(),d("form",{action:"",class:"user-ship-form",onSubmit:X(c,["prevent"])},[e("div",tt,[st,P(e("input",{type:"text",class:"input",placeholder:`Example: Best ${t.ship.name}`,"onUpdate:modelValue":h[0]||(h[0]=l=>o.name=l)},null,8,ot),[[z,o.name]])]),e("div",lt,[nt,e("div",it,[(n(!0),d(A,null,T(v(u)+1,l=>(n(),d("div",{class:Y(["chip cursor-pointer",{"chip--unlocked":l-1<=o.chip_level}]),key:l,onClick:p=>o.chip_level=l-1},k(l-1),11,at))),128))])]),t.userShip?(n(),d("div",rt,[ct,e("div",null,[x(Ze,{modelValue:o.visible,"onUpdate:modelValue":h[1]||(h[1]=l=>o.visible=l),label:o.visible?"Visible to workshops":"Hidden from workshops"},null,8,["modelValue","label"])])])):M("",!0),e("div",dt,[e("div",null,[e("button",{class:"btn btn-blue",type:"submit",disabled:i.value},[i.value?(n(),F(v(Q),{key:0,class:"animate-spin"})):(n(),d(A,{key:1},[I(k(t.userShip?"Update Ship":"Add Ship"),1)],64))],8,ut)]),t.userShip&&t.onDelete?(n(),d("div",ht,[e("button",{class:"btn btn-red",type:"submit",onClick:h[2]||(h[2]=X(l=>m(t.userShip),["prevent"])),disabled:i.value},[i.value?(n(),F(v(Q),{key:0,class:"animate-spin"})):(n(),d(A,{key:1},[I(" Delete ")],64))],8,_t)])):M("",!0)])],40,et))}},he=D(pt,[["__scopeId","data-v-9f8a73d4"]]);const mt=t=>(R("data-v-7884a63c"),t=t(),E(),t),ft={class:"ship-box__content"},vt={class:"ship-box__content-bg p-2 flex w-full gapx-3"},bt={class:"grow"},yt={class:"ship-box__strengths flex gap-x-2 items-center"},xt=mt(()=>e("div",{class:"mr-4 font-medium"},"Total Strength",-1)),gt={class:"ship-box__strengths-total text-center text-xs"},kt={class:"text-base font-medium text-grow-green-text-alt"},St={class:"ship-box__strengths-total text-center text-xs"},wt={class:"text-base font-medium text-grow-green-text-alt"},$t={class:"ship-box__strengths-total text-center text-xs"},Ct={class:"text-base font-medium text-grow-green-text-alt"},Ft={class:"ship-box__actions ml-auto shrink"},Ut={class:"ship-box__caption"},At={__name:"ShipSelectCard",props:{ship:{type:Object,required:!0}},setup(t){return(s,r)=>(n(),d("div",{class:Y(["ship ship-box",["ship-box--"+t.ship.ship_level.name.toLowerCase()]])},[e("div",ft,[e("div",vt,[e("div",bt,[e("div",null,"Power "+k(t.ship.energy),1),e("div",null,k(t.ship.abilities.length)+" Abilities",1),e("div",yt,[xt,e("div",gt,[I(" Weapons "),e("div",kt,k(t.ship.slotStrengths.weapon.total),1)]),e("div",St,[I(" Armor "),e("div",wt,k(t.ship.slotStrengths.armor.total),1)]),e("div",$t,[I(" Units "),e("div",Ct,k(t.ship.slotStrengths.unit.total),1)])])]),e("div",Ft,[H(s.$slots,"actions",{},void 0,!0)])])]),e("div",Ut,k(t.ship.name),1)],2))}},It=D(At,[["__scopeId","data-v-7884a63c"]]),Wt={class:"add-ship__filters flex gap-x-4 items-center mb-4"},Mt=e("div",{class:"text-modal-title font-medium"},"Filter by name",-1),Lt=e("div",{class:"text-modal-title font-medium"},"Filter by class",-1),jt={key:0,class:"pt-6"},qt={class:"add-ships__list flex flex-col w-full gap-y-2"},Dt=["onClick"],Vt={__name:"ShipSelectList",props:{ships:{type:Array,required:!0},shipClasses:{type:Array,required:!0}},emits:["select"],setup(t,{emit:s}){const r=t,i=u=>{s("select",u)},o=B({search:"",id_class:null}),c=C(()=>Object.values(o).some(u=>!!u)),m=()=>{o.search="",o.id_class=null},b=C(()=>{let u=[...r.ships];return o.search&&(u=u.filter(_=>_.name.toLowerCase().includes(o.search.toLowerCase()))),o.id_class&&(u=u.filter(_=>_.id_class===o.id_class)),u});return(u,_)=>{const h=V("VSelect");return n(),d(A,null,[e("div",Wt,[e("div",null,[Mt,P(e("input",{type:"text",class:"input input--search",placeholder:"Search by name...","onUpdate:modelValue":_[0]||(_[0]=l=>o.search=l)},null,512),[[z,o.search]])]),e("div",null,[Lt,x(h,{options:t.shipClasses,reduce:l=>l.id_class,searchable:!0,clearable:!0,label:"name",modelValue:o.id_class,"onUpdate:modelValue":_[1]||(_[1]=l=>o.id_class=l)},null,8,["options","reduce","modelValue"])]),v(c)?(n(),d("div",jt,[e("button",{class:"btn btn-sm btn-red",onClick:m}," Clear filters ")])):M("",!0)]),e("div",qt,[(n(!0),d(A,null,T(v(b),l=>(n(),F(It,{key:l.id_ship,ship:l},{actions:U(()=>[e("button",{class:"btn btn-sm btn-green",onClick:p=>i(l)}," Select ",8,Dt)]),_:2},1032,["ship"]))),128))])],64)}}};const Bt={class:"add-ship"},Ot={class:"text-xl text-modal-title font-medium mb-4"},Tt={class:"flex gap-x-4 items-center mb-4"},Nt={class:"text-xl text-modal-title"},Pt={__name:"AddShipModal",props:{ships:{type:Array,required:!0},shipClasses:{type:Array,required:!0},onAdd:{type:Function,required:!0},title:{type:String,default:"Add a ship to your fleet"}},setup(t){const s=t,r=q(null),i=c=>{r.value=c},o=c=>s.onAdd(c);return(c,m)=>{const b=V("vue-final-modal");return n(),F(b,{classes:"modal-container","content-class":"w-full modal-content--xl"},{default:U(()=>[x(J,{class:"w-full","bg-class":"custom-bg"},{default:U(()=>[e("div",Bt,[e("h2",Ot,k(t.title),1),r.value?(n(),d(A,{key:0},[e("div",Tt,[e("div",null,[e("button",{class:"btn btn-sm btn-red",onClick:m[0]||(m[0]=u=>r.value=null)}," Unselect Ship ")]),e("div",null,[e("h2",Nt,[I(" Add "),e("b",null,k(r.value.name),1),I(" to your fleet ")])])]),x(he,{ship:r.value,onSave:o},null,8,["ship"])],64)):(n(),F(Vt,{key:1,ships:t.ships,shipClasses:t.shipClasses,onSelect:i},null,8,["ships","shipClasses"]))])]),_:1})]),_:1})}}};const Rt=t=>(R("data-v-221f881d"),t=t(),E(),t),Et={class:"ship-box__content"},Ht={class:"ship-box__content-bg p-2 flex w-full gap-x-3"},zt={class:"shrink"},Yt={class:"flex w-full justify-between"},Gt={class:"flex gap-x-2 items-center text-sm mb-1"},Jt={class:"flex gap-x-[2px] items-center"},Kt={class:"ship-box__strengths flex gap-x-2 items-center"},Qt={class:"ship-box__strengths-total text-center text-xs"},Xt={class:"text-base font-medium text-grow-green-text-alt"},Zt={class:"ship-box__strengths-total text-center text-xs"},es={class:"text-base font-medium text-grow-green-text-alt"},ts={class:"ship-box__strengths-total text-center text-xs"},ss={class:"text-base font-medium text-grow-green-text-alt"},os={class:"ship__tags grow"},ls={key:0,class:"flex flex-wrap gap-[2px]"},ns={class:"ship__actions"},is=Rt(()=>e("button",{class:"btn btn-sm btn-green ml-auto"}," Edit ",-1)),as={class:"ship-box__caption flex gap-x-4 justify-center"},rs={class:"text-white italic"},cs={__name:"UserShipCard",props:{userShip:{type:Object,required:!0},showTags:{type:Boolean,default:!0}},setup(t){return(s,r)=>{const i=ye("tooltip");return P((n(),d("div",{class:Y(["ship ship-box relative leading-none",["ship-box--"+t.userShip.ship.ship_level.name.toLowerCase(),{"ship--hidden":!t.userShip.visible}]])},[e("div",Et,[e("div",Ht,[e("div",zt,[e("div",Yt,[e("div",Gt,[e("div",null,k(t.userShip.ship.ship_class.name),1),e("div",Jt,[e("div",null,[x(v(Oe))]),e("div",null,k(t.userShip.ship.energy),1)]),e("div",null,[x(Te,{total:t.userShip.ship.chipCount,chipLevel:t.userShip.chip_level,height:"8px"},null,8,["total","chipLevel"])])])]),e("div",Kt,[e("div",Qt,[I(" Weapons "),e("div",Xt,k(t.userShip.ship.slotStrengths.weapon.total),1)]),e("div",Zt,[I(" Armor "),e("div",es,k(t.userShip.ship.slotStrengths.armor.total),1)]),e("div",ts,[I(" Units "),e("div",ss,k(t.userShip.ship.slotStrengths.unit.total),1)])])]),e("div",os,[H(s.$slots,"tags",{},()=>{var o;return[t.showTags&&((o=t.userShip.parsedAbilities)!=null&&o.length)?(n(),d("div",ls,[(n(!0),d(A,null,T(t.userShip.parsedAbilities,c=>(n(),F(Ne,{key:c.ability.id_ability,parsedAbility:c},null,8,["parsedAbility"]))),128))])):M("",!0)]},!0)]),e("div",ns,[H(s.$slots,"actions",{},()=>[is],!0)])])]),e("div",as,[e("div",null,k(t.userShip.ship.name),1),e("div",rs,k(t.userShip.name),1)])],2)),[[i,t.userShip.visible?!1:"Hidden from workshops"]])}}},ie=D(cs,[["__scopeId","data-v-221f881d"]]);const ds={class:"add-ship"},us=e("h2",{class:"text-xl text-modal-title font-medium mb-4"}," Update your ship ",-1),hs={__name:"UserShipModal",props:{userShip:{type:Object,required:!0},onSave:{type:Function,required:!0},onDelete:{type:Function,default:null}},setup(t){const s=t,r=o=>s.onSave(o),i=o=>{if(s.onDelete)return s.onDelete(o)};return(o,c)=>{const m=V("vue-final-modal");return n(),F(m,{classes:"modal-container","content-class":"w-full modal-content--xl"},{default:U(()=>[x(J,{class:"w-full","bg-class":"custom-bg"},{default:U(()=>[e("div",ds,[us,x(he,{ship:t.userShip.ship,userShip:t.userShip,onSave:r,onDelete:i},null,8,["ship","userShip"])])]),_:1})]),_:1})}}};const K=t=>(R("data-v-74af7c7c"),t=t(),E(),t),_s=["onSubmit"],ps={class:"create-workshop"},ms=K(()=>e("h2",{class:"text-xl text-modal-title font-medium mb-2"}," Create Workshop ",-1)),fs=K(()=>e("p",{class:"text-white mb-4"},"Select your Workshop type",-1)),vs={class:"lg:flex gap-x-4 mb-4"},bs=K(()=>e("h2",{class:"text-white text-xl mb-4"},"Arcade Workshop",-1)),ys=K(()=>e("p",{class:"text-dark-text-white"}," Create with no restrictions! Use your same ship as many times as you want. ",-1)),xs=[bs,ys],gs=K(()=>e("h2",{class:"text-white text-xl mb-4"},"Simulation Workshop",-1)),ks=K(()=>e("p",{class:"text-dark-text-white"}," More realistic. You can only use each of the ships in your fleet one time. ",-1)),Ss=[gs,ks],ws={class:"form-group"},$s={class:"form-group"},Cs=["disabled"],Fs={__name:"WorkshopForm",props:{workshop:{type:Object,default:null},onSave:{type:Function,required:!0}},setup(t){const s=t,r=G(),i=B({name:"",arcade:!0}),o=B({name:""}),c=B({name:!1}),m=q(!1),b=q(!1),u=()=>(o.name=i.name?"":"Name is required",!Object.values(o).some(h=>h)),_=async()=>{if(m.value=!0,b.value)try{await s.onSave(i)}catch(h){r.error(h.message)}m.value=!1};return Z(i,()=>{b.value=u()}),xe(()=>{s.workshop&&(i.name=s.workshop.name,i.arcade=s.workshop.arcade)}),(h,l)=>(n(),d("form",{action:"",onSubmit:X(_,["prevent"])},[e("div",ps,[ms,fs,e("div",vs,[e("div",{class:Y(["p-4 bordered lg:w-1/2 text-center",{"bordered--selected":i.arcade}]),onClick:l[0]||(l[0]=p=>i.arcade=!0)},xs,2),e("div",{class:Y(["p-4 bordered lg:w-1/2",{"bordered--selected":!i.arcade}]),onClick:l[1]||(l[1]=p=>i.arcade=!1)},Ss,2)]),e("div",ws,[P(e("input",{class:"input",type:"text",placeholder:"Fleet name","onUpdate:modelValue":l[2]||(l[2]=p=>i.name=p)},null,512),[[z,i.name]]),x(oe,{error:o.name,dirty:c.name},null,8,["error","dirty"])]),e("div",$s,[e("button",{class:"btn btn-blue",disabled:!b.value}," Create Workshop ",8,Cs)])])],40,_s))}},Us=D(Fs,[["__scopeId","data-v-74af7c7c"]]);const As={__name:"CreateWorkshopModal",props:{workshop:{type:Object,default:null},onSave:{type:Function,required:!0}},setup(t){const s=t;return(r,i)=>{const o=V("vue-final-modal");return n(),F(o,{classes:"modal-container","content-class":"w-full modal-content--xl"},{default:U(()=>[x(J,{class:"w-full","bg-class":"custom-bg"},{default:U(()=>[x(Us,{onSave:s.onSave,workshop:t.workshop},null,8,["onSave","workshop"])]),_:1})]),_:1})}}},Is=D(As,[["__scopeId","data-v-ee57fd14"]]);const Ws={class:"flex items-center"},Ms={class:"border-r border-dark-border-end pr-4 grow"},Ls={class:"flex w-100"},js={class:"mr-4"},qs={class:"text-sm text-dark-text"},Ds={class:"text-2xl font-medium text-dark-text leading-none text-white"},Vs={class:"self-end ml-auto"},Bs={class:"text-sm"},Os={class:"text-sm"},Ts={class:"pl-4 shrink"},Ns=["onClick"],Ps={__name:"WorkshopListItem",props:{workshop:{type:Object,default:null},onDelete:{type:Function,required:!0}},emits:["select"],setup(t,{emit:s}){const r=t,i=C(()=>r.workshop.fleets.length),o=C(()=>r.workshop.fleets.reduce((b,u)=>b+u.user_ships.length,0)),c=()=>{r.onDelete(ee(r.workshop))},m=()=>{s("select",ee(r.workshop))};return(b,u)=>(n(),d("div",{class:"workshop-list-item cursor-pointer p-4",onClick:m},[e("div",Ws,[e("div",Ms,[e("div",Ls,[e("div",js,[e("div",qs,k(t.workshop.arcade?"Arcade":"Simulation"),1),e("div",Ds,k(t.workshop.name),1)]),e("div",Vs,[e("div",Bs,[I(" Ships: "),e("b",null,k(v(o)),1)]),e("div",Os,[I(" Fleets: "),e("b",null,k(v(i)),1)])])])]),e("div",Ts,[e("button",{class:"btn btn-red btn-sm",onClick:X(c,["stop","prevent"])},[x(v(ge))],8,Ns)])])]))}},Rs=D(Ps,[["__scopeId","data-v-454717a1"]]);const Es={class:"modal__title text-2xl font-medium mb-8"},Hs={class:"modal__content p-6 mb-6"},zs={class:"modal__footer flex justify-end items-center gap-x-3"},Ys=["onClick"],Gs=["onClick"],se=t=>{L.show({component:"confirm-modal",bind:{title:t.title,message:t.message,onConfirm:t.onConfirm,onCancel:t.onCancel,confirmBtnClass:t.confirmBtnClass}})},Js={__name:"ConfirmModal",props:{onConfirm:{type:Function,required:!0},onCancel:{type:Function,default:null},title:{type:String,default:!1},message:{type:String,default:!1},confirmBtnClass:{type:String,default:"btn-red"}},setup(t){const s=t,r=o=>{s.onCancel(),o()},i=o=>{typeof s.onConfirm=="function"&&s.onConfirm(),o()};return(o,c)=>{const m=V("vue-final-modal");return n(),F(m,{name:"confirm-modal",classes:"modal-container","content-class":"w-full modal-content--xl"},{default:U(({close:b})=>[x(J,{class:"w-full text-modal-text","bg-class":"custom-bg"},{default:U(()=>[e("div",Es,[H(o.$slots,"title",{},()=>[I(k(t.title),1)],!0)]),e("div",Hs,[H(o.$slots,"default",{},()=>[I(k(t.message),1)],!0)]),e("div",zs,[H(o.$slots,"buttons",{},()=>[e("button",{class:"btn btn-blue",onClick:u=>r(b)}," Cancel ",8,Ys),e("button",{class:Y(["btn",t.confirmBtnClass]),onClick:u=>i(b)}," Confirm ",10,Gs)],!0)])]),_:2},1024)]),_:3})}}},Ks=D(Js,[["__scopeId","data-v-53e089bb"]]);const _e=t=>(R("data-v-a908151b"),t=t(),E(),t),Qs={class:"flex w-full justify-end p-4"},Xs={class:"my-fleets flex w-full justify-center items-center"},Zs={class:"my-fleets__content w-full max-w-6xl p-6 text-modal-text"},eo={class:"lg:flex w-full items-stretch gap-x-6"},to={class:"my-fleets__fleets h-full grow"},so={class:"flex items-end w-full mb-2"},oo=_e(()=>e("div",null,[e("div",{class:"title text-2xl text-modal-title font-medium leading-none"}," My Ships ")],-1)),lo={class:"ml-auto"},no={class:"bordered p-4"},io={class:"user-ships grid grid-cols-2 gap-3 w-full"},ao={key:0,class:"placeholder p-10 flex justify-center items-center text-center text-xl h-full"},ro={key:1,class:"p-10 flex justify-center items-center text-3xl"},co={class:"my-fleets__workshops h-full shrink-0 lg:max-w-[410px]"},uo={class:"flex w-full items-end mb-2"},ho=_e(()=>e("div",null,[e("div",{class:"title leading-none text-2xl text-modal-title font-medium"}," My Workshops ")],-1)),_o={class:"ml-auto"},po={class:"bordered p-4 grid gap-y-2"},mo={key:0,class:"flex placeholder p-10 justify-center items-center text-center text-xl h-full"},fo={key:1,class:"p-10 flex justify-center items-center text-3xl"},vo={__name:"MyFleets",setup(t){const s=le(),r=ke(),i=Se(),o=G(),c=()=>{L.show({component:Is,bind:{onSave:async a=>{await s.createWorkshop(a),L.hideAll()}}})},m=()=>{L.show({component:Pt,bind:{ships:s.ships,shipClasses:s.shipClasses,onAdd:async a=>{await s.createOrUpdateUserShip(a),L.hideAll()}}})},b=a=>{L.show({component:hs,bind:{ship:a.ship,userShip:a,onSave:async g=>{await s.createOrUpdateUserShip(g),L.hideAll()},onDelete:async g=>{await s.deleteUserShip(g.id_user_ship),L.hideAll()}}})},u=a=>{i.push({name:"builder.workshop",params:{id_workshop:a.id_workshop}})},_=async a=>{se({title:`Really delete ${a.arcade?"arcade":"simulation"} workshop "${a.name}" ?`,message:"On a moral level, it's totally fine. Your ships will be fine, as well. But all fleet configurations will be gone. Proceed?",onConfirm:()=>{h(a)}})},h=async a=>{se({title:"For sure?",message:`Think of all the fun you and workshop "${a.name}" had together.`,onConfirm:()=>{l(a)}})},l=async a=>{se({title:"Last chance for real!",message:"Think of the children...",onConfirm:()=>{s.deleteWorkshop(a.id_workshop),o.info("Workshop delete successfully")}})},p=()=>{r.logout()},y=q(!1);return ce(()=>{const a=s.ships.length?Promise.resolve():s.loadShips(),g=s.userShips.length?Promise.resolve():s.loadUserShips(),O=s.shipClasses.length?Promise.resolve():s.loadShipClasses(),W=s.workshops.length?Promise.resolve():s.loadWorkshops();Promise.all([a,g,O,W]).then(()=>{y.value=!0})}),(a,g)=>{const O=V("router-link");return n(),F(de,null,{default:U(()=>[e("div",Qs,[x(O,{to:"/",class:"banner__link",onClick:p},{default:U(()=>[I(" Logout ")]),_:1})]),e("div",Xs,[e("div",Zs,[e("div",eo,[e("div",to,[e("div",so,[oo,e("div",lo,[y.value?(n(),d("button",{key:0,class:"btn btn-blue btn-sm ml-4",onClick:m}," Add Ship ")):M("",!0)])]),e("div",no,[y.value?(n(),d(A,{key:0},[e("div",io,[(n(!0),d(A,null,T(v(s).userShips,W=>(n(),F(ie,{key:W.id_user_ship,userShip:W,showTags:!1,onClick:ae=>b(W)},null,8,["userShip","onClick"]))),128))]),v(s).userShips.length?M("",!0):(n(),d("div",ao," There are no ships in your fleet. Create one. "))],64)):(n(),d("div",ro,[x(v(Q),{class:"animate-spin"})]))])]),e("div",co,[e("div",uo,[ho,e("div",_o,[y.value?(n(),d("button",{key:0,class:"btn btn-blue btn-sm ml-4",onClick:c}," Add Workshop ")):M("",!0)])]),e("div",po,[y.value?(n(),d(A,{key:0},[(n(!0),d(A,null,T(v(s).workshops,W=>(n(),F(Rs,{key:W.id_workshop,workshop:W,onDelete:_,onSelect:u},null,8,["workshop"]))),128)),v(s).workshops.length?M("",!0):(n(),d("div",mo," No workshops yet. Create one! "))],64)):(n(),d("div",fo,[x(v(Q),{class:"animate-spin"})]))])])])])])]),_:1})}}},bo=D(vo,[["__scopeId","data-v-a908151b"]]),yo={class:"add-ship__filters flex gap-x-4 items-center mb-4"},xo=e("div",{class:"text-modal-title font-medium"},"Filter by name",-1),go=e("div",{class:"text-modal-title font-medium"},"Filter by class",-1),ko={key:0,class:"pt-6"},So={class:"add-ships__list flex flex-col w-full gap-y-2"},wo={key:0,class:"btn btn-sm btn-gray",disabled:""},$o=["onClick"],Co=["onClick"],Fo={key:1,class:"btn btn-sm btn-gray",disabled:""},Uo={__name:"UserShipSelectList",props:{userShips:{type:Array,required:!0},shipClasses:{type:Array,required:!0},busy:{type:Boolean,default:!1},energyLimit:{type:Number,default:null}},emits:["select","unselect"],setup(t,{emit:s}){const r=t,i=l=>{s("select",l)},o=l=>{s("unselect",l)},c=B({search:"",id_class:null}),m=C(()=>Object.values(c).some(l=>!!l)),b=()=>{c.search="",c.id_class=null},u=C(()=>r.energyLimit!==null),_=l=>u.value?l<=r.energyLimit:!0,h=C(()=>{let l=[...r.userShips];return c.search&&(l=l.filter(p=>p.ship.name.toLowerCase().includes(c.search.toLowerCase()))),c.id_class&&(l=l.filter(p=>p.ship.id_class===c.id_class)),l});return(l,p)=>{const y=V("VSelect");return n(),d(A,null,[e("div",yo,[e("div",null,[xo,P(e("input",{type:"text",class:"input input--search",placeholder:"Search by name...","onUpdate:modelValue":p[0]||(p[0]=a=>c.search=a)},null,512),[[z,c.search]])]),e("div",null,[go,x(y,{options:t.shipClasses,reduce:a=>a.id_class,searchable:!0,clearable:!0,label:"name",modelValue:c.id_class,"onUpdate:modelValue":p[1]||(p[1]=a=>c.id_class=a)},null,8,["options","reduce","modelValue"])]),v(m)?(n(),d("div",ko,[e("button",{class:"btn btn-sm btn-red",onClick:b}," Clear filters ")])):M("",!0)]),e("div",So,[(n(!0),d(A,null,T(v(h),a=>(n(),F(ie,{key:a.id_user_ship,userShip:a},{actions:U(()=>[t.busy?(n(),d("button",wo,[x(v(Q),{class:"animate-spin"})])):a.selected?(n(),d("button",{key:1,class:"btn btn-sm btn-red",onClick:g=>o(a)}," Unselect ",8,$o)):(n(),d(A,{key:2},[_(a.ship.energy)?(n(),d("button",{key:0,class:"btn btn-sm btn-green",onClick:g=>i(a)}," Select ",8,Co)):(n(),d("button",Fo," Not enough energy "))],64))]),_:2},1032,["userShip"]))),128))])],64)}}};const Ao={__name:"SelectUserShipModal",props:{fleet:{type:Object,required:!0},userShips:{type:Object,required:!0},shipClasses:{type:Array,required:!0},busy:{type:Object,default:!1}},emits:["select","unselect"],setup(t,{emit:s}){const r=t,i=u=>{s("select",u)},o=u=>{s("unselect",u)},c=C(()=>r.busy.value),m=C(()=>r.userShips.value),b=C(()=>{var u,_;return((_=(u=r.fleet.value)==null?void 0:u.stats)==null?void 0:_.leadershipRemaining)||null});return(u,_)=>{const h=V("vue-final-modal");return n(),F(h,{classes:"modal-container","content-class":"w-full modal-content--lg"},{default:U(()=>[x(J,{class:"w-full","bg-class":"custom-bg"},{default:U(()=>[t.fleet.value?(n(),F(ue,{key:0,fleet:t.fleet.value,class:"bg-dark-bg-start/50 p-4"},null,8,["fleet"])):M("",!0),x(Uo,{userShips:v(m),shipClasses:t.shipClasses,busy:v(c),energyLimit:v(b),onSelect:i,onUnselect:o},null,8,["userShips","shipClasses","busy","energyLimit"])]),_:1})]),_:1})}}};const pe=t=>(R("data-v-e7712255"),t=t(),E(),t),Io=["onSubmit"],Wo={class:"flex gap-x-3 justify-between"},Mo={class:"text-xl modal__title font-medium mb-6"},Lo={key:0},jo=["disabled"],qo={class:"form-group"},Do=pe(()=>e("label",null,"Fleet Name",-1)),Vo={class:"form-group mb-10"},Bo=pe(()=>e("label",null,"Leadership Capacity",-1)),Oo={key:0,class:"mb-2"},To={key:1,class:"select-list p-4 mb-8 flex flex-col gap-y-2"},No=["onClick"],Po={class:"form-group pt-4"},Ro=["disabled"],Eo={key:0},Ho={key:1},zo={__name:"FleetFormModal",props:{idWorkshop:{type:Number,required:!0},location:{type:Object,required:!0},fleet:{type:Object,default:null},onSave:{type:Function,required:!0},onDelete:{type:Function,required:!0},excludeSelected:{type:Boolean,default:!1},onSelectShip:{type:Function,required:!0},onUnselectShip:{type:Function,required:!0}},setup(t){const s=t,r=G(),i=le(),o=B({name:"",leadership:0}),c=B({name:"",leadership:""}),m=B({name:!1,leadership:!1}),b=q(!1),u=q(""),_=q(!1),h=q(!1),l=()=>{o.name?c.name="":c.name="Name is required",o.leadership?c.leadership="":c.leadership="Leadership is required",b.value=!Object.values(c).some(S=>!!S)},p=async()=>{var S,f,$;if(b.value){_.value=!0;try{await s.onSave(s.location.slug,{...ee(o),id_workshop_fleet:(S=s.fleet)==null?void 0:S.id_workshop_fleet})}catch(w){r.error((($=(f=w.response)==null?void 0:f.data)==null?void 0:$.message)||w.message)}_.value=!1}},y=async S=>{_.value=!0;try{await s.onDelete(S)}catch(f){u.value=f.message}_.value=!1},a=async S=>{var f,$;h.value=!0;try{await s.onUnselectShip(s.fleet.id_workshop_fleet,S.id_user_ship)}catch(w){r.error((($=(f=w.response)==null?void 0:f.data)==null?void 0:$.message)||w.message)}h.value=!1},g=async S=>{var f,$;h.value=!0;try{await s.onSelectShip(s.fleet.id_workshop_fleet,S.id_user_ship)}catch(w){r.error((($=(f=w.response)==null?void 0:f.data)==null?void 0:$.message)||w.message)}h.value=!1},O=()=>{L.show({component:Ao,bind:{fleet:W,userShips:fe,shipClasses:re.value,busy:h,onSelect:g,onUnselect:a}})},W=C(()=>{var f;return(f=i.selectedFleets)==null?void 0:f.find($=>{var w;return $.id_workshop_fleet===((w=s.fleet)==null?void 0:w.id_workshop_fleet)})}),ae=C(()=>{var S,f;return(f=(S=W.value)==null?void 0:S.user_ships)==null?void 0:f.map($=>$.id_user_ship)}),me=C(()=>{var S;return(S=i.selectedFleets)==null?void 0:S.filter(f=>{var $;return f.id_workshop_fleet!==(($=s.fleet)==null?void 0:$.id_workshop_fleet)}).reduce((f,$)=>[...f,...$.user_ships.map(w=>w.id_user_ship)],[])}),re=C(()=>i.shipClasses),fe=C(()=>{var w,te;const S=(te=(w=W.value)==null?void 0:w.user_ships)==null?void 0:te.map(j=>j.id_user_ship);let f=i.userShips.map(j=>ee(j)).filter(j=>j.visible);s.excludeSelected&&(f=f.filter(j=>S.includes(j.id_user_ship)?!0:!me.value.includes(j.id_user_ship)));const $=f.map(j=>({...j,selected:ae.value.includes(j.id_user_ship)}));return we($,S),$});return Z(o,l,{immediate:!0}),Z(W,S=>{S&&(o.name=S.name,o.leadership=S.leadership)},{immediate:!0}),(S,f)=>{const $=V("vue-final-modal");return n(),F($,{classes:"modal-container","content-class":"w-full modal-content--xl"},{default:U(()=>[x(J,{class:"w-full","bg-class":"custom-bg"},{default:U(()=>[e("form",{action:"",class:"fleet-form",onSubmit:X(p,["prevent"])},[e("div",Wo,[e("div",null,[e("h2",Mo,k(t.location.name),1)]),t.fleet?(n(),d("div",Lo,[e("button",{class:"btn btn-red btn-sm",type:"button",onClick:f[0]||(f[0]=w=>y(t.fleet.id_workshop_fleet)),disabled:_.value},[_.value?(n(),d(A,{key:0},[I(" Deleting... ")],64)):(n(),d(A,{key:1},[I(" Delete ")],64))],8,jo)])):M("",!0)]),e("div",qo,[Do,P(e("input",{type:"text",class:"form-control","onUpdate:modelValue":f[1]||(f[1]=w=>o.name=w)},null,512),[[z,o.name]]),x(oe,{error:c.name,dirty:m.name},null,8,["error","dirty"])]),e("div",Vo,[Bo,P(e("input",{type:"text",class:"form-control","onUpdate:modelValue":f[2]||(f[2]=w=>o.leadership=w)},null,512),[[z,o.leadership]]),x(oe,{error:c.leadership,dirty:m.leadership},null,8,["error","dirty"])]),t.fleet?(n(),d("div",Oo,[e("button",{type:"button",class:"btn btn-bright-blue btn-sm",onClick:O}," Add Ship ")])):M("",!0),t.fleet?(n(),d("div",To,[x(ue,{fleet:v(W),class:"mb-4"},null,8,["fleet"]),(n(!0),d(A,null,T(v(W).user_ships,w=>(n(),F(ie,{key:w.id_user_ship,userShip:w,shipClasses:v(re)},{actions:U(()=>[e("button",{class:"btn btn-sm btn-red",type:"button",onClick:te=>a(w)}," Unselect ",8,No)]),_:2},1032,["userShip","shipClasses"]))),128))])):M("",!0),e("div",Po,[e("button",{class:"btn btn-blue w-full block",disabled:!b.value||_.value,type:"submit"},[_.value?(n(),d("span",Eo,"Saving...")):(n(),d("span",Ho,"Save"))],8,Ro)])],40,Io)]),_:1})]),_:1})}}},Yo=D(zo,[["__scopeId","data-v-e7712255"]]),Go={viewBox:"0 0 448 512",width:"1.2em",height:"1.2em"},Jo=e("path",{fill:"currentColor",d:"m257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"},null,-1),Ko=[Jo];function Qo(t,s){return n(),d("svg",Go,Ko)}const Xo={name:"fa-solid-arrow-left",render:Qo},Zo={class:"share-bar"},el={class:"flex rounded dark-border-end border-1 overflow-hidden items-stretch"},tl=["value"],sl={__name:"ShareWorkshop",props:{id_workshop:{type:[String,Number],required:!0}},setup(t){const s=t,r=q(null),i=G(),o=C(()=>window.location.origin+"/share/"+s.id_workshop),{copy:c,isSupported:m}=$e(),b=async()=>{await c(o.value),u()},u=Ce.debounce(()=>{m.value&&i.success("Copied to clipboard")},750),_=l=>{b(),l.target.select(),l.target.setSelectionRange(0,9999)},h=()=>{_({target:r.value})};return(l,p)=>(n(),d("div",Zo,[e("div",el,[e("div",{class:"bg-box-gray text-box-gray-text flex justify-center items-center px-3 cursor-pointer",onClick:h},[x(v(Pe))]),e("div",null,[e("input",{ref_key:"inputRef",ref:r,type:"text",class:"input-clean",readonly:"",value:v(o),onFocus:_},null,40,tl)])])]))}};const ol={class:"workshop max-w-6xl flex flex-col justify-center mx-auto pt-6"},ll={class:"workshop__heading mb-8"},nl={class:"mb-2"},il={class:"flex items-center"},al={class:"text-2xl font-medium mb-2 modal__title"},rl={class:"font-xl text-white"},cl={class:"ml-auto"},dl={class:"workshop__content w-full text-modal-text"},ul={class:"grid gap-x-4 gap-y-8 w-full"},hl={__name:"Workshop",setup(t){const s=Fe(),r=Ue.getFleetLocations(),i=le(),o=q(!1),c=G(),m=(h,l)=>{var p;L.show({component:Yo,bind:{idWorkshop:(p=u.value)==null?void 0:p.id_workshop,location:h,fleet:l,excludeSelected:!u.value.arcade,onSave:async(y,a)=>{var O;const g=await i.createOrUpdateFleet((O=u.value)==null?void 0:O.id_workshop,y,a);a.id_workshop_fleet||(L.hideAll(),m(h,g)),c.success("Fleet saved successfully")},onDelete:async y=>{var a;await i.deleteFleet((a=u.value)==null?void 0:a.id_workshop,y),L.hideAll()},onSelectShip:(y,a)=>{var g;return i.addUserShipToFleet((g=u.value)==null?void 0:g.id_workshop,y,a)},onUnselectShip:(y,a)=>{var g;return i.removeUserShipFromFleet((g=u.value)==null?void 0:g.id_workshop,y,a)}}})},b=(h,l)=>{var p;return i.setFleetFlagship((p=u.value)==null?void 0:p.id_workshop,h.id_workshop_fleet,l.id_user_ship).catch(y=>{var a,g;console.warn("Error setting flagship",y),c.error(((g=(a=y.response)==null?void 0:a.data)==null?void 0:g.message)||y.message)})},u=C(()=>i.workshops.find(h=>h.id_workshop===parseInt(s.params.id_workshop))),_=C(()=>r.map(h=>{var p,y;const l=(p=i.selectedFleets)==null?void 0:p.find(a=>a.location===h.slug);return{...h,statTotals:l&&((y=i.selectedFleetsStats)==null?void 0:y[l.id_workshop_fleet])||null,fleet:l}}));return ce(async()=>{const h=i.ships.length?Promise.resolve():i.loadShips(),l=i.userShips.length?Promise.resolve():i.loadUserShips(),p=i.shipClasses.length?Promise.resolve():i.loadShipClasses(),y=i.workshops.length?Promise.resolve():i.loadWorkshops();await Promise.all([h,l,p,y]).then(()=>{o.value=!0}),i.setSelectedWorkshopId(s.params.id_workshop)}),(h,l)=>{const p=V("router-link");return n(),F(de,null,{default:U(()=>{var y,a;return[e("div",ol,[e("div",ll,[e("div",nl,[x(p,{class:"text-grow-green-text-alt flex gap-x-2 items-center",to:{name:"builder.fleets"}},{default:U(()=>[x(v(Xo)),I(" Back to Fleets ")]),_:1},8,["to"])]),e("div",il,[e("div",null,[e("h1",al,k(((y=v(u))==null?void 0:y.name)||"Workshop"),1),e("p",rl,k((a=v(u))!=null&&a.arcade?"Arcade":"Simulation"),1)]),e("div",cl,[x(sl,{id_workshop:v(s).params.id_workshop},null,8,["id_workshop"])])])]),x(Re),e("div",dl,[e("div",ul,[(n(!0),d(A,null,T(v(_),g=>(n(),F(Ee,{key:g.slug,location:g.slug,locationName:g.name,fleet:g.fleet,statTotals:g.statTotals,onSelect:m,onFlagship:b},null,8,["location","locationName","fleet","statTotals"]))),128))])])])]}),_:1})}}},_l=D(hl,[["__scopeId","data-v-10eb961e"]]),pl=[{path:"/",component:bo,name:"builder.fleets"},{path:"/workshop/:id_workshop",component:_l,name:"builder.workshop"}],ml=Ae({history:Ie("/builder"),routes:pl}),N=We(Be),fl=Me();N.use(fl);N.component("VSelect",Le);N.component("ConfirmModal",Ks);N.use(ml);N.use(je);N.directive("tooltip",qe);N.use(De,{position:Ve.TOP_RIGHT,timeout:3e3});N.mount("#app");He();

import{_ as D,o as n,f as d,a as e,aw as ve,t as k,z as R,A as E,s as Y,k as j,j as B,E as C,ak as be,l as Z,m as P,v as z,F as A,y as T,S as G,e as v,b as x,n as M,c as F,I as Q,g as I,p as X,d as H,r as V,w as U,U as ye,B as xe,am as oe,ao as ge,af as ee,$ as L,u as ke,h as Se,G as ce,ax as we,ay as $e,a2 as Ce,C as Fe,D as Ue,H as Ae,J as Ie,K as We,L as Me,Q as Le,M as qe,O as je,N as De,P as Ve,R as Be}from"./index-474b6c89.js";import{C as J,I as Oe,a as Te,A as Ne,u as le,B as de,b as ue,S as Pe,F as Re}from"./FleetItem-3ca40883.js";import{u as Ee}from"./useMustAuthState-e6f98085.js";const He={props:{label:{type:String,required:!0},modelValue:{type:Boolean,required:!0}}},ze=t=>(R("data-v-154813cc"),t=t(),E(),t),Ge={class:"toggle-switch"},Ye=["checked"],Je=ze(()=>e("span",{class:"switch"},null,-1)),Ke={class:"label"};function Qe(t,s,r,i,o,c){return n(),d("label",Ge,[e("input",ve(t.$attrs,{class:"input",type:"checkbox",checked:r.modelValue,onChange:s[0]||(s[0]=m=>t.$emit("update:modelValue",m.target.checked))}),null,16,Ye),Je,e("span",Ke,k(r.label),1)])}const Xe=D(He,[["render",Qe],["__scopeId","data-v-154813cc"]]);const ne=t=>(R("data-v-9f8a73d4"),t=t(),E(),t),Ze=["onSubmit"],et={class:"form-group"},tt=ne(()=>e("label",null,"Nickname (optional identifier for your sanity)",-1)),st=["placeholder"],ot={class:"form-group"},lt=ne(()=>e("label",null,"Chip Level",-1)),nt={class:"chips flex gap-x-1"},it=["onClick"],at={key:0,class:"form-group"},rt=ne(()=>e("label",null,"Visibility",-1)),ct={class:"form-group pt-4 flex gap-x-4 justify-between"},dt=["disabled"],ut={key:0},ht=["disabled"],_t={__name:"UserShipForm",props:{ship:{type:Object,required:!0},userShip:{type:Object,default:null},onSave:{type:Function,required:!0},onDelete:{type:Function,default:null}},setup(t){const s=t,r=Y(),i=j(!1),o=B({name:"",chip_level:0,visible:!0}),c=async()=>{var _,h,l;i.value=!0;try{s.onSave({...o,id_ship:s.ship.id_ship,id_user_ship:(_=s.userShip)==null?void 0:_.id_user_ship})}catch(p){r.error(((l=(h=error.response)==null?void 0:h.data)==null?void 0:l.message)||p.message)}i.value=!1},m=async _=>{var h,l;if(!s.onDelete)return!1;i.value=!0;try{s.onDelete(_)}catch(p){r.error(((l=(h=error.response)==null?void 0:h.data)==null?void 0:l.message)||p.message)}i.value=!1},b=()=>{s.userShip?(o.name=s.userShip.name,o.chip_level=s.userShip.chip_level,o.visible=s.userShip.visible):(o.name="",o.chip_level=0,o.visible=!0)},u=C(()=>be(s.ship));return Z(()=>s.userShip,()=>{b()},{immediate:!0}),(_,h)=>(n(),d("form",{action:"",class:"user-ship-form",onSubmit:X(c,["prevent"])},[e("div",et,[tt,P(e("input",{type:"text",class:"input",placeholder:`Example: Best ${t.ship.name}`,"onUpdate:modelValue":h[0]||(h[0]=l=>o.name=l)},null,8,st),[[z,o.name]])]),e("div",ot,[lt,e("div",nt,[(n(!0),d(A,null,T(v(u)+1,l=>(n(),d("div",{class:G(["chip cursor-pointer",{"chip--unlocked":l-1<=o.chip_level}]),key:l,onClick:p=>o.chip_level=l-1},k(l-1),11,it))),128))])]),t.userShip?(n(),d("div",at,[rt,e("div",null,[x(Xe,{modelValue:o.visible,"onUpdate:modelValue":h[1]||(h[1]=l=>o.visible=l),label:o.visible?"Visible to workshops":"Hidden from workshops"},null,8,["modelValue","label"])])])):M("",!0),e("div",ct,[e("div",null,[e("button",{class:"btn btn-blue",type:"submit",disabled:i.value},[i.value?(n(),F(v(Q),{key:0,class:"animate-spin"})):(n(),d(A,{key:1},[I(k(t.userShip?"Update Ship":"Add Ship"),1)],64))],8,dt)]),t.userShip&&t.onDelete?(n(),d("div",ut,[e("button",{class:"btn btn-red",type:"submit",onClick:h[2]||(h[2]=X(l=>m(t.userShip),["prevent"])),disabled:i.value},[i.value?(n(),F(v(Q),{key:0,class:"animate-spin"})):(n(),d(A,{key:1},[I(" Delete ")],64))],8,ht)])):M("",!0)])],40,Ze))}},he=D(_t,[["__scopeId","data-v-9f8a73d4"]]);const pt=t=>(R("data-v-7884a63c"),t=t(),E(),t),mt={class:"ship-box__content"},ft={class:"ship-box__content-bg p-2 flex w-full gapx-3"},vt={class:"grow"},bt={class:"ship-box__strengths flex gap-x-2 items-center"},yt=pt(()=>e("div",{class:"mr-4 font-medium"},"Total Strength",-1)),xt={class:"ship-box__strengths-total text-center text-xs"},gt={class:"text-base font-medium text-grow-green-text-alt"},kt={class:"ship-box__strengths-total text-center text-xs"},St={class:"text-base font-medium text-grow-green-text-alt"},wt={class:"ship-box__strengths-total text-center text-xs"},$t={class:"text-base font-medium text-grow-green-text-alt"},Ct={class:"ship-box__actions ml-auto shrink"},Ft={class:"ship-box__caption"},Ut={__name:"ShipSelectCard",props:{ship:{type:Object,required:!0}},setup(t){return(s,r)=>(n(),d("div",{class:G(["ship ship-box",["ship-box--"+t.ship.ship_level.name.toLowerCase()]])},[e("div",mt,[e("div",ft,[e("div",vt,[e("div",null,"Power "+k(t.ship.energy),1),e("div",null,k(t.ship.abilities.length)+" Abilities",1),e("div",bt,[yt,e("div",xt,[I(" Weapons "),e("div",gt,k(t.ship.slotStrengths.weapon.total),1)]),e("div",kt,[I(" Armor "),e("div",St,k(t.ship.slotStrengths.armor.total),1)]),e("div",wt,[I(" Units "),e("div",$t,k(t.ship.slotStrengths.unit.total),1)])])]),e("div",Ct,[H(s.$slots,"actions",{},void 0,!0)])])]),e("div",Ft,k(t.ship.name),1)],2))}},At=D(Ut,[["__scopeId","data-v-7884a63c"]]),It={class:"add-ship__filters flex gap-x-4 items-center mb-4"},Wt=e("div",{class:"text-modal-title font-medium"},"Filter by name",-1),Mt=e("div",{class:"text-modal-title font-medium"},"Filter by class",-1),Lt={key:0,class:"pt-6"},qt={class:"add-ships__list flex flex-col w-full gap-y-2"},jt=["onClick"],Dt={__name:"ShipSelectList",props:{ships:{type:Array,required:!0},shipClasses:{type:Array,required:!0}},emits:["select"],setup(t,{emit:s}){const r=t,i=u=>{s("select",u)},o=B({search:"",id_class:null}),c=C(()=>Object.values(o).some(u=>!!u)),m=()=>{o.search="",o.id_class=null},b=C(()=>{let u=[...r.ships];return o.search&&(u=u.filter(_=>_.name.toLowerCase().includes(o.search.toLowerCase()))),o.id_class&&(u=u.filter(_=>_.id_class===o.id_class)),u});return(u,_)=>{const h=V("VSelect");return n(),d(A,null,[e("div",It,[e("div",null,[Wt,P(e("input",{type:"text",class:"input input--search",placeholder:"Search by name...","onUpdate:modelValue":_[0]||(_[0]=l=>o.search=l)},null,512),[[z,o.search]])]),e("div",null,[Mt,x(h,{options:t.shipClasses,reduce:l=>l.id_class,searchable:!0,clearable:!0,label:"name",modelValue:o.id_class,"onUpdate:modelValue":_[1]||(_[1]=l=>o.id_class=l)},null,8,["options","reduce","modelValue"])]),v(c)?(n(),d("div",Lt,[e("button",{class:"btn btn-sm btn-red",onClick:m}," Clear filters ")])):M("",!0)]),e("div",qt,[(n(!0),d(A,null,T(v(b),l=>(n(),F(At,{key:l.id_ship,ship:l},{actions:U(()=>[e("button",{class:"btn btn-sm btn-green",onClick:p=>i(l)}," Select ",8,jt)]),_:2},1032,["ship"]))),128))])],64)}}};const Vt={class:"add-ship"},Bt={class:"text-xl text-modal-title font-medium mb-4"},Ot={class:"flex gap-x-4 items-center mb-4"},Tt={class:"text-xl text-modal-title"},Nt={__name:"AddShipModal",props:{ships:{type:Array,required:!0},shipClasses:{type:Array,required:!0},onAdd:{type:Function,required:!0},title:{type:String,default:"Add a ship to your fleet"}},setup(t){const s=t,r=j(null),i=c=>{r.value=c},o=c=>s.onAdd(c);return(c,m)=>{const b=V("vue-final-modal");return n(),F(b,{classes:"modal-container","content-class":"w-full modal-content--xl"},{default:U(()=>[x(J,{class:"w-full","bg-class":"custom-bg"},{default:U(()=>[e("div",Vt,[e("h2",Bt,k(t.title),1),r.value?(n(),d(A,{key:0},[e("div",Ot,[e("div",null,[e("button",{class:"btn btn-sm btn-red",onClick:m[0]||(m[0]=u=>r.value=null)}," Unselect Ship ")]),e("div",null,[e("h2",Tt,[I(" Add "),e("b",null,k(r.value.name),1),I(" to your fleet ")])])]),x(he,{ship:r.value,onSave:o},null,8,["ship"])],64)):(n(),F(Dt,{key:1,ships:t.ships,shipClasses:t.shipClasses,onSelect:i},null,8,["ships","shipClasses"]))])]),_:1})]),_:1})}}};const Pt=t=>(R("data-v-221f881d"),t=t(),E(),t),Rt={class:"ship-box__content"},Et={class:"ship-box__content-bg p-2 flex w-full gap-x-3"},Ht={class:"shrink"},zt={class:"flex w-full justify-between"},Gt={class:"flex gap-x-2 items-center text-sm mb-1"},Yt={class:"flex gap-x-[2px] items-center"},Jt={class:"ship-box__strengths flex gap-x-2 items-center"},Kt={class:"ship-box__strengths-total text-center text-xs"},Qt={class:"text-base font-medium text-grow-green-text-alt"},Xt={class:"ship-box__strengths-total text-center text-xs"},Zt={class:"text-base font-medium text-grow-green-text-alt"},es={class:"ship-box__strengths-total text-center text-xs"},ts={class:"text-base font-medium text-grow-green-text-alt"},ss={class:"ship__tags grow"},os={key:0,class:"flex flex-wrap gap-[2px]"},ls={class:"ship__actions"},ns=Pt(()=>e("button",{class:"btn btn-sm btn-green ml-auto"}," Edit ",-1)),is={class:"ship-box__caption flex gap-x-4 justify-center"},as={class:"text-white italic"},rs={__name:"UserShipCard",props:{userShip:{type:Object,required:!0},showTags:{type:Boolean,default:!0}},setup(t){return(s,r)=>{const i=ye("tooltip");return P((n(),d("div",{class:G(["ship ship-box relative leading-none",["ship-box--"+t.userShip.ship.ship_level.name.toLowerCase(),{"ship--hidden":!t.userShip.visible}]])},[e("div",Rt,[e("div",Et,[e("div",Ht,[e("div",zt,[e("div",Gt,[e("div",null,k(t.userShip.ship.ship_class.name),1),e("div",Yt,[e("div",null,[x(v(Oe))]),e("div",null,k(t.userShip.ship.energy),1)]),e("div",null,[x(Te,{total:t.userShip.ship.chipCount,chipLevel:t.userShip.chip_level,height:"8px"},null,8,["total","chipLevel"])])])]),e("div",Jt,[e("div",Kt,[I(" Weapons "),e("div",Qt,k(t.userShip.ship.slotStrengths.weapon.total),1)]),e("div",Xt,[I(" Armor "),e("div",Zt,k(t.userShip.ship.slotStrengths.armor.total),1)]),e("div",es,[I(" Units "),e("div",ts,k(t.userShip.ship.slotStrengths.unit.total),1)])])]),e("div",ss,[H(s.$slots,"tags",{},()=>{var o;return[t.showTags&&((o=t.userShip.parsedAbilities)!=null&&o.length)?(n(),d("div",os,[(n(!0),d(A,null,T(t.userShip.parsedAbilities,c=>(n(),F(Ne,{key:c.ability.id_ability,parsedAbility:c},null,8,["parsedAbility"]))),128))])):M("",!0)]},!0)]),e("div",ls,[H(s.$slots,"actions",{},()=>[ns],!0)])])]),e("div",is,[e("div",null,k(t.userShip.ship.name),1),e("div",as,k(t.userShip.name),1)])],2)),[[i,t.userShip.visible?!1:"Hidden from workshops"]])}}},ie=D(rs,[["__scopeId","data-v-221f881d"]]);const cs={class:"add-ship"},ds=e("h2",{class:"text-xl text-modal-title font-medium mb-4"}," Update your ship ",-1),us={__name:"UserShipModal",props:{userShip:{type:Object,required:!0},onSave:{type:Function,required:!0},onDelete:{type:Function,default:null}},setup(t){const s=t,r=o=>s.onSave(o),i=o=>{if(s.onDelete)return s.onDelete(o)};return(o,c)=>{const m=V("vue-final-modal");return n(),F(m,{classes:"modal-container","content-class":"w-full modal-content--xl"},{default:U(()=>[x(J,{class:"w-full","bg-class":"custom-bg"},{default:U(()=>[e("div",cs,[ds,x(he,{ship:t.userShip.ship,userShip:t.userShip,onSave:r,onDelete:i},null,8,["ship","userShip"])])]),_:1})]),_:1})}}};const K=t=>(R("data-v-74af7c7c"),t=t(),E(),t),hs=["onSubmit"],_s={class:"create-workshop"},ps=K(()=>e("h2",{class:"text-xl text-modal-title font-medium mb-2"}," Create Workshop ",-1)),ms=K(()=>e("p",{class:"text-white mb-4"},"Select your Workshop type",-1)),fs={class:"lg:flex gap-x-4 mb-4"},vs=K(()=>e("h2",{class:"text-white text-xl mb-4"},"Arcade Workshop",-1)),bs=K(()=>e("p",{class:"text-dark-text-white"}," Create with no restrictions! Use your same ship as many times as you want. ",-1)),ys=[vs,bs],xs=K(()=>e("h2",{class:"text-white text-xl mb-4"},"Simulation Workshop",-1)),gs=K(()=>e("p",{class:"text-dark-text-white"}," More realistic. You can only use each of the ships in your fleet one time. ",-1)),ks=[xs,gs],Ss={class:"form-group"},ws={class:"form-group"},$s=["disabled"],Cs={__name:"WorkshopForm",props:{workshop:{type:Object,default:null},onSave:{type:Function,required:!0}},setup(t){const s=t,r=Y(),i=B({name:"",arcade:!0}),o=B({name:""}),c=B({name:!1}),m=j(!1),b=j(!1),u=()=>(o.name=i.name?"":"Name is required",!Object.values(o).some(h=>h)),_=async()=>{if(m.value=!0,b.value)try{await s.onSave(i)}catch(h){r.error(h.message)}m.value=!1};return Z(i,()=>{b.value=u()}),xe(()=>{s.workshop&&(i.name=s.workshop.name,i.arcade=s.workshop.arcade)}),(h,l)=>(n(),d("form",{action:"",onSubmit:X(_,["prevent"])},[e("div",_s,[ps,ms,e("div",fs,[e("div",{class:G(["p-4 bordered lg:w-1/2 text-center",{"bordered--selected":i.arcade}]),onClick:l[0]||(l[0]=p=>i.arcade=!0)},ys,2),e("div",{class:G(["p-4 bordered lg:w-1/2",{"bordered--selected":!i.arcade}]),onClick:l[1]||(l[1]=p=>i.arcade=!1)},ks,2)]),e("div",Ss,[P(e("input",{class:"input",type:"text",placeholder:"Fleet name","onUpdate:modelValue":l[2]||(l[2]=p=>i.name=p)},null,512),[[z,i.name]]),x(oe,{error:o.name,dirty:c.name},null,8,["error","dirty"])]),e("div",ws,[e("button",{class:"btn btn-blue",disabled:!b.value}," Create Workshop ",8,$s)])])],40,hs))}},Fs=D(Cs,[["__scopeId","data-v-74af7c7c"]]);const Us={__name:"CreateWorkshopModal",props:{workshop:{type:Object,default:null},onSave:{type:Function,required:!0}},setup(t){const s=t;return(r,i)=>{const o=V("vue-final-modal");return n(),F(o,{classes:"modal-container","content-class":"w-full modal-content--xl"},{default:U(()=>[x(J,{class:"w-full","bg-class":"custom-bg"},{default:U(()=>[x(Fs,{onSave:s.onSave,workshop:t.workshop},null,8,["onSave","workshop"])]),_:1})]),_:1})}}},As=D(Us,[["__scopeId","data-v-ee57fd14"]]);const Is={class:"flex items-center"},Ws={class:"border-r border-dark-border-end pr-4 grow"},Ms={class:"flex w-100"},Ls={class:"mr-4"},qs={class:"text-sm text-dark-text"},js={class:"text-2xl font-medium text-dark-text leading-none text-white"},Ds={class:"self-end ml-auto"},Vs={class:"text-sm"},Bs={class:"text-sm"},Os={class:"pl-4 shrink"},Ts=["onClick"],Ns={__name:"WorkshopListItem",props:{workshop:{type:Object,default:null},onDelete:{type:Function,required:!0}},emits:["select"],setup(t,{emit:s}){const r=t,i=C(()=>r.workshop.fleets.length),o=C(()=>r.workshop.fleets.reduce((b,u)=>b+u.user_ships.length,0)),c=()=>{r.onDelete(ee(r.workshop))},m=()=>{s("select",ee(r.workshop))};return(b,u)=>(n(),d("div",{class:"workshop-list-item cursor-pointer p-4",onClick:m},[e("div",Is,[e("div",Ws,[e("div",Ms,[e("div",Ls,[e("div",qs,k(t.workshop.arcade?"Arcade":"Simulation"),1),e("div",js,k(t.workshop.name),1)]),e("div",Ds,[e("div",Vs,[I(" Ships: "),e("b",null,k(v(o)),1)]),e("div",Bs,[I(" Fleets: "),e("b",null,k(v(i)),1)])])])]),e("div",Os,[e("button",{class:"btn btn-red btn-sm",onClick:X(c,["stop","prevent"])},[x(v(ge))],8,Ts)])])]))}},Ps=D(Ns,[["__scopeId","data-v-454717a1"]]);const Rs={class:"modal__title text-2xl font-medium mb-8"},Es={class:"modal__content p-6 mb-6"},Hs={class:"modal__footer flex justify-end items-center gap-x-3"},zs=["onClick"],Gs=["onClick"],se=t=>{L.show({component:"confirm-modal",bind:{title:t.title,message:t.message,onConfirm:t.onConfirm,onCancel:t.onCancel,confirmBtnClass:t.confirmBtnClass}})},Ys={__name:"ConfirmModal",props:{onConfirm:{type:Function,required:!0},onCancel:{type:Function,default:null},title:{type:String,default:!1},message:{type:String,default:!1},confirmBtnClass:{type:String,default:"btn-red"}},setup(t){const s=t,r=o=>{s.onCancel(),o()},i=o=>{typeof s.onConfirm=="function"&&s.onConfirm(),o()};return(o,c)=>{const m=V("vue-final-modal");return n(),F(m,{name:"confirm-modal",classes:"modal-container","content-class":"w-full modal-content--xl"},{default:U(({close:b})=>[x(J,{class:"w-full text-modal-text","bg-class":"custom-bg"},{default:U(()=>[e("div",Rs,[H(o.$slots,"title",{},()=>[I(k(t.title),1)],!0)]),e("div",Es,[H(o.$slots,"default",{},()=>[I(k(t.message),1)],!0)]),e("div",Hs,[H(o.$slots,"buttons",{},()=>[e("button",{class:"btn btn-blue",onClick:u=>r(b)}," Cancel ",8,zs),e("button",{class:G(["btn",t.confirmBtnClass]),onClick:u=>i(b)}," Confirm ",10,Gs)],!0)])]),_:2},1024)]),_:3})}}},Js=D(Ys,[["__scopeId","data-v-53e089bb"]]);const _e=t=>(R("data-v-a908151b"),t=t(),E(),t),Ks={class:"flex w-full justify-end p-4"},Qs={class:"my-fleets flex w-full justify-center items-center"},Xs={class:"my-fleets__content w-full max-w-6xl p-6 text-modal-text"},Zs={class:"lg:flex w-full items-stretch gap-x-6"},eo={class:"my-fleets__fleets h-full grow"},to={class:"flex items-end w-full mb-2"},so=_e(()=>e("div",null,[e("div",{class:"title text-2xl text-modal-title font-medium leading-none"}," My Ships ")],-1)),oo={class:"ml-auto"},lo={class:"bordered p-4"},no={class:"user-ships grid grid-cols-2 gap-3 w-full"},io={key:0,class:"placeholder p-10 flex justify-center items-center text-center text-xl h-full"},ao={key:1,class:"p-10 flex justify-center items-center text-3xl"},ro={class:"my-fleets__workshops h-full shrink-0 lg:max-w-[410px]"},co={class:"flex w-full items-end mb-2"},uo=_e(()=>e("div",null,[e("div",{class:"title leading-none text-2xl text-modal-title font-medium"}," My Workshops ")],-1)),ho={class:"ml-auto"},_o={class:"bordered p-4 grid gap-y-2"},po={key:0,class:"flex placeholder p-10 justify-center items-center text-center text-xl h-full"},mo={key:1,class:"p-10 flex justify-center items-center text-3xl"},fo={__name:"MyFleets",setup(t){const s=le(),r=ke(),i=Se(),o=Y(),c=()=>{L.show({component:As,bind:{onSave:async a=>{await s.createWorkshop(a),L.hideAll()}}})},m=()=>{L.show({component:Nt,bind:{ships:s.ships,shipClasses:s.shipClasses,onAdd:async a=>{await s.createOrUpdateUserShip(a),L.hideAll()}}})},b=a=>{L.show({component:us,bind:{ship:a.ship,userShip:a,onSave:async g=>{await s.createOrUpdateUserShip(g),L.hideAll()},onDelete:async g=>{await s.deleteUserShip(g.id_user_ship),L.hideAll()}}})},u=a=>{i.push({name:"builder.workshop",params:{id_workshop:a.id_workshop}})},_=async a=>{se({title:`Really delete ${a.arcade?"arcade":"simulation"} workshop "${a.name}" ?`,message:"On a moral level, it's totally fine. Your ships will be fine, as well. But all fleet configurations will be gone. Proceed?",onConfirm:()=>{h(a)}})},h=async a=>{se({title:"For sure?",message:`Think of all the fun you and workshop "${a.name}" had together.`,onConfirm:()=>{l(a)}})},l=async a=>{se({title:"Last chance for real!",message:"Think of the children...",onConfirm:()=>{s.deleteWorkshop(a.id_workshop),o.info("Workshop delete successfully")}})},p=()=>{r.logout()},y=j(!1);return ce(()=>{const a=s.ships.length?Promise.resolve():s.loadShips(),g=s.userShips.length?Promise.resolve():s.loadUserShips(),O=s.shipClasses.length?Promise.resolve():s.loadShipClasses(),W=s.workshops.length?Promise.resolve():s.loadWorkshops();Promise.all([a,g,O,W]).then(()=>{y.value=!0})}),(a,g)=>{const O=V("router-link");return n(),F(de,null,{default:U(()=>[e("div",Ks,[x(O,{to:"/",class:"banner__link",onClick:p},{default:U(()=>[I(" Logout ")]),_:1})]),e("div",Qs,[e("div",Xs,[e("div",Zs,[e("div",eo,[e("div",to,[so,e("div",oo,[y.value?(n(),d("button",{key:0,class:"btn btn-blue btn-sm ml-4",onClick:m}," Add Ship ")):M("",!0)])]),e("div",lo,[y.value?(n(),d(A,{key:0},[e("div",no,[(n(!0),d(A,null,T(v(s).userShips,W=>(n(),F(ie,{key:W.id_user_ship,userShip:W,showTags:!1,onClick:ae=>b(W)},null,8,["userShip","onClick"]))),128))]),v(s).userShips.length?M("",!0):(n(),d("div",io," There are no ships in your fleet. Create one. "))],64)):(n(),d("div",ao,[x(v(Q),{class:"animate-spin"})]))])]),e("div",ro,[e("div",co,[uo,e("div",ho,[y.value?(n(),d("button",{key:0,class:"btn btn-blue btn-sm ml-4",onClick:c}," Add Workshop ")):M("",!0)])]),e("div",_o,[y.value?(n(),d(A,{key:0},[(n(!0),d(A,null,T(v(s).workshops,W=>(n(),F(Ps,{key:W.id_workshop,workshop:W,onDelete:_,onSelect:u},null,8,["workshop"]))),128)),v(s).workshops.length?M("",!0):(n(),d("div",po," No workshops yet. Create one! "))],64)):(n(),d("div",mo,[x(v(Q),{class:"animate-spin"})]))])])])])])]),_:1})}}},vo=D(fo,[["__scopeId","data-v-a908151b"]]),bo={class:"add-ship__filters flex gap-x-4 items-center mb-4"},yo=e("div",{class:"text-modal-title font-medium"},"Filter by name",-1),xo=e("div",{class:"text-modal-title font-medium"},"Filter by class",-1),go={key:0,class:"pt-6"},ko={class:"add-ships__list flex flex-col w-full gap-y-2"},So={key:0,class:"btn btn-sm btn-gray",disabled:""},wo=["onClick"],$o=["onClick"],Co={key:1,class:"btn btn-sm btn-gray",disabled:""},Fo={__name:"UserShipSelectList",props:{userShips:{type:Array,required:!0},shipClasses:{type:Array,required:!0},busy:{type:Boolean,default:!1},energyLimit:{type:Number,default:null}},emits:["select","unselect"],setup(t,{emit:s}){const r=t,i=l=>{s("select",l)},o=l=>{s("unselect",l)},c=B({search:"",id_class:null}),m=C(()=>Object.values(c).some(l=>!!l)),b=()=>{c.search="",c.id_class=null},u=C(()=>r.energyLimit!==null),_=l=>u.value?l<=r.energyLimit:!0,h=C(()=>{let l=[...r.userShips];return c.search&&(l=l.filter(p=>p.ship.name.toLowerCase().includes(c.search.toLowerCase()))),c.id_class&&(l=l.filter(p=>p.ship.id_class===c.id_class)),l});return(l,p)=>{const y=V("VSelect");return n(),d(A,null,[e("div",bo,[e("div",null,[yo,P(e("input",{type:"text",class:"input input--search",placeholder:"Search by name...","onUpdate:modelValue":p[0]||(p[0]=a=>c.search=a)},null,512),[[z,c.search]])]),e("div",null,[xo,x(y,{options:t.shipClasses,reduce:a=>a.id_class,searchable:!0,clearable:!0,label:"name",modelValue:c.id_class,"onUpdate:modelValue":p[1]||(p[1]=a=>c.id_class=a)},null,8,["options","reduce","modelValue"])]),v(m)?(n(),d("div",go,[e("button",{class:"btn btn-sm btn-red",onClick:b}," Clear filters ")])):M("",!0)]),e("div",ko,[(n(!0),d(A,null,T(v(h),a=>(n(),F(ie,{key:a.id_user_ship,userShip:a},{actions:U(()=>[t.busy?(n(),d("button",So,[x(v(Q),{class:"animate-spin"})])):a.selected?(n(),d("button",{key:1,class:"btn btn-sm btn-red",onClick:g=>o(a)}," Unselect ",8,wo)):(n(),d(A,{key:2},[_(a.ship.energy)?(n(),d("button",{key:0,class:"btn btn-sm btn-green",onClick:g=>i(a)}," Select ",8,$o)):(n(),d("button",Co," Not enough energy "))],64))]),_:2},1032,["userShip"]))),128))])],64)}}};const Uo={__name:"SelectUserShipModal",props:{fleet:{type:Object,required:!0},userShips:{type:Object,required:!0},shipClasses:{type:Array,required:!0},busy:{type:Object,default:!1}},emits:["select","unselect"],setup(t,{emit:s}){const r=t,i=u=>{s("select",u)},o=u=>{s("unselect",u)},c=C(()=>r.busy.value),m=C(()=>r.userShips.value),b=C(()=>{var u,_;return((_=(u=r.fleet.value)==null?void 0:u.stats)==null?void 0:_.leadershipRemaining)||null});return(u,_)=>{const h=V("vue-final-modal");return n(),F(h,{classes:"modal-container","content-class":"w-full modal-content--lg"},{default:U(()=>[x(J,{class:"w-full","bg-class":"custom-bg"},{default:U(()=>[t.fleet.value?(n(),F(ue,{key:0,fleet:t.fleet.value,class:"bg-dark-bg-start/50 p-4"},null,8,["fleet"])):M("",!0),x(Fo,{userShips:v(m),shipClasses:t.shipClasses,busy:v(c),energyLimit:v(b),onSelect:i,onUnselect:o},null,8,["userShips","shipClasses","busy","energyLimit"])]),_:1})]),_:1})}}};const pe=t=>(R("data-v-e7712255"),t=t(),E(),t),Ao=["onSubmit"],Io={class:"flex gap-x-3 justify-between"},Wo={class:"text-xl modal__title font-medium mb-6"},Mo={key:0},Lo=["disabled"],qo={class:"form-group"},jo=pe(()=>e("label",null,"Fleet Name",-1)),Do={class:"form-group mb-10"},Vo=pe(()=>e("label",null,"Leadership Capacity",-1)),Bo={key:0,class:"mb-2"},Oo={key:1,class:"select-list p-4 mb-8 flex flex-col gap-y-2"},To=["onClick"],No={class:"form-group pt-4"},Po=["disabled"],Ro={key:0},Eo={key:1},Ho={__name:"FleetFormModal",props:{idWorkshop:{type:Number,required:!0},location:{type:Object,required:!0},fleet:{type:Object,default:null},onSave:{type:Function,required:!0},onDelete:{type:Function,required:!0},excludeSelected:{type:Boolean,default:!1},onSelectShip:{type:Function,required:!0},onUnselectShip:{type:Function,required:!0}},setup(t){const s=t,r=Y(),i=le(),o=B({name:"",leadership:0}),c=B({name:"",leadership:""}),m=B({name:!1,leadership:!1}),b=j(!1),u=j(""),_=j(!1),h=j(!1),l=()=>{o.name?c.name="":c.name="Name is required",o.leadership?c.leadership="":c.leadership="Leadership is required",b.value=!Object.values(c).some(S=>!!S)},p=async()=>{var S,f,$;if(b.value){_.value=!0;try{await s.onSave(s.location.slug,{...ee(o),id_workshop_fleet:(S=s.fleet)==null?void 0:S.id_workshop_fleet})}catch(w){r.error((($=(f=w.response)==null?void 0:f.data)==null?void 0:$.message)||w.message)}_.value=!1}},y=async S=>{_.value=!0;try{await s.onDelete(S)}catch(f){u.value=f.message}_.value=!1},a=async S=>{var f,$;h.value=!0;try{await s.onUnselectShip(s.fleet.id_workshop_fleet,S.id_user_ship)}catch(w){r.error((($=(f=w.response)==null?void 0:f.data)==null?void 0:$.message)||w.message)}h.value=!1},g=async S=>{var f,$;h.value=!0;try{await s.onSelectShip(s.fleet.id_workshop_fleet,S.id_user_ship)}catch(w){r.error((($=(f=w.response)==null?void 0:f.data)==null?void 0:$.message)||w.message)}h.value=!1},O=()=>{L.show({component:Uo,bind:{fleet:W,userShips:fe,shipClasses:re.value,busy:h,onSelect:g,onUnselect:a}})},W=C(()=>{var f;return(f=i.selectedFleets)==null?void 0:f.find($=>{var w;return $.id_workshop_fleet===((w=s.fleet)==null?void 0:w.id_workshop_fleet)})}),ae=C(()=>{var S,f;return(f=(S=W.value)==null?void 0:S.user_ships)==null?void 0:f.map($=>$.id_user_ship)}),me=C(()=>{var S;return(S=i.selectedFleets)==null?void 0:S.filter(f=>{var $;return f.id_workshop_fleet!==(($=s.fleet)==null?void 0:$.id_workshop_fleet)}).reduce((f,$)=>[...f,...$.user_ships.map(w=>w.id_user_ship)],[])}),re=C(()=>i.shipClasses),fe=C(()=>{var w,te;const S=(te=(w=W.value)==null?void 0:w.user_ships)==null?void 0:te.map(q=>q.id_user_ship);let f=i.userShips.map(q=>ee(q)).filter(q=>q.visible);s.excludeSelected&&(f=f.filter(q=>S.includes(q.id_user_ship)?!0:!me.value.includes(q.id_user_ship)));const $=f.map(q=>({...q,selected:ae.value.includes(q.id_user_ship)}));return we($,S),$});return Z(o,l,{immediate:!0}),Z(W,S=>{S&&(o.name=S.name,o.leadership=S.leadership)},{immediate:!0}),(S,f)=>{const $=V("vue-final-modal");return n(),F($,{classes:"modal-container","content-class":"w-full modal-content--xl"},{default:U(()=>[x(J,{class:"w-full","bg-class":"custom-bg"},{default:U(()=>[e("form",{action:"",class:"fleet-form",onSubmit:X(p,["prevent"])},[e("div",Io,[e("div",null,[e("h2",Wo,k(t.location.name),1)]),t.fleet?(n(),d("div",Mo,[e("button",{class:"btn btn-red btn-sm",type:"button",onClick:f[0]||(f[0]=w=>y(t.fleet.id_workshop_fleet)),disabled:_.value},[_.value?(n(),d(A,{key:0},[I(" Deleting... ")],64)):(n(),d(A,{key:1},[I(" Delete ")],64))],8,Lo)])):M("",!0)]),e("div",qo,[jo,P(e("input",{type:"text",class:"form-control","onUpdate:modelValue":f[1]||(f[1]=w=>o.name=w)},null,512),[[z,o.name]]),x(oe,{error:c.name,dirty:m.name},null,8,["error","dirty"])]),e("div",Do,[Vo,P(e("input",{type:"text",class:"form-control","onUpdate:modelValue":f[2]||(f[2]=w=>o.leadership=w)},null,512),[[z,o.leadership]]),x(oe,{error:c.leadership,dirty:m.leadership},null,8,["error","dirty"])]),t.fleet?(n(),d("div",Bo,[e("button",{type:"button",class:"btn btn-bright-blue btn-sm",onClick:O}," Add Ship ")])):M("",!0),t.fleet?(n(),d("div",Oo,[x(ue,{fleet:v(W),class:"mb-4"},null,8,["fleet"]),(n(!0),d(A,null,T(v(W).user_ships,w=>(n(),F(ie,{key:w.id_user_ship,userShip:w,shipClasses:v(re)},{actions:U(()=>[e("button",{class:"btn btn-sm btn-red",type:"button",onClick:te=>a(w)}," Unselect ",8,To)]),_:2},1032,["userShip","shipClasses"]))),128))])):M("",!0),e("div",No,[e("button",{class:"btn btn-blue w-full block",disabled:!b.value||_.value,type:"submit"},[_.value?(n(),d("span",Ro,"Saving...")):(n(),d("span",Eo,"Save"))],8,Po)])],40,Ao)]),_:1})]),_:1})}}},zo=D(Ho,[["__scopeId","data-v-e7712255"]]),Go={viewBox:"0 0 448 512",width:"1.2em",height:"1.2em"},Yo=e("path",{fill:"currentColor",d:"m257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"},null,-1),Jo=[Yo];function Ko(t,s){return n(),d("svg",Go,Jo)}const Qo={name:"fa-solid-arrow-left",render:Ko},Xo={class:"share-bar"},Zo={class:"flex rounded dark-border-end border-1 overflow-hidden items-stretch"},el=["value"],tl={__name:"ShareWorkshop",props:{id_workshop:{type:[String,Number],required:!0}},setup(t){const s=t,r=j(null),i=Y(),o=C(()=>window.location.origin+"/share/"+s.id_workshop),{copy:c,isSupported:m}=$e(),b=async()=>{await c(o.value),u()},u=Ce.debounce(()=>{m.value&&i.success("Copied to clipboard")},750),_=l=>{b(),l.target.select(),l.target.setSelectionRange(0,9999)},h=()=>{_({target:r.value})};return(l,p)=>(n(),d("div",Xo,[e("div",Zo,[e("div",{class:"bg-box-gray text-box-gray-text flex justify-center items-center px-3 cursor-pointer",onClick:h},[x(v(Pe))]),e("div",null,[e("input",{ref_key:"inputRef",ref:r,type:"text",class:"input-clean",readonly:"",value:v(o),onFocus:_},null,40,el)])])]))}};const sl={class:"workshop max-w-6xl flex flex-col justify-center mx-auto pt-6"},ol={class:"workshop__heading mb-8"},ll={class:"mb-2"},nl={class:"flex items-center"},il={class:"text-2xl font-medium mb-2 modal__title"},al={class:"font-xl text-white"},rl={class:"ml-auto"},cl={class:"workshop__content w-full text-modal-text"},dl={class:"grid gap-x-4 gap-y-8 w-full"},ul={__name:"Workshop",setup(t){const s=Fe(),r=Ue.getFleetLocations(),i=le(),o=j(!1),c=Y(),m=(h,l)=>{var p;L.show({component:zo,bind:{idWorkshop:(p=u.value)==null?void 0:p.id_workshop,location:h,fleet:l,excludeSelected:!u.value.arcade,onSave:async(y,a)=>{var O;const g=await i.createOrUpdateFleet((O=u.value)==null?void 0:O.id_workshop,y,a);a.id_workshop_fleet||(L.hideAll(),m(h,g)),c.success("Fleet saved successfully")},onDelete:async y=>{var a;await i.deleteFleet((a=u.value)==null?void 0:a.id_workshop,y),L.hideAll()},onSelectShip:(y,a)=>{var g;return i.addUserShipToFleet((g=u.value)==null?void 0:g.id_workshop,y,a)},onUnselectShip:(y,a)=>{var g;return i.removeUserShipFromFleet((g=u.value)==null?void 0:g.id_workshop,y,a)}}})},b=(h,l)=>{var p;return i.setFleetFlagship((p=u.value)==null?void 0:p.id_workshop,h.id_workshop_fleet,l.id_user_ship).catch(y=>{var a,g;console.warn("Error setting flagship",y),c.error(((g=(a=y.response)==null?void 0:a.data)==null?void 0:g.message)||y.message)})},u=C(()=>i.workshops.find(h=>h.id_workshop===parseInt(s.params.id_workshop))),_=C(()=>r.map(h=>{var p,y;const l=(p=i.selectedFleets)==null?void 0:p.find(a=>a.location===h.slug);return{...h,statTotals:l&&((y=i.selectedFleetsStats)==null?void 0:y[l.id_workshop_fleet])||null,fleet:l}}));return ce(async()=>{const h=i.ships.length?Promise.resolve():i.loadShips(),l=i.userShips.length?Promise.resolve():i.loadUserShips(),p=i.shipClasses.length?Promise.resolve():i.loadShipClasses(),y=i.workshops.length?Promise.resolve():i.loadWorkshops();await Promise.all([h,l,p,y]).then(()=>{o.value=!0}),i.setSelectedWorkshopId(s.params.id_workshop)}),(h,l)=>{const p=V("router-link");return n(),F(de,null,{default:U(()=>{var y,a;return[e("div",sl,[e("div",ol,[e("div",ll,[x(p,{class:"text-grow-green-text-alt flex gap-x-2 items-center",to:{name:"builder.fleets"}},{default:U(()=>[x(v(Qo)),I(" Back to Fleets ")]),_:1},8,["to"])]),e("div",nl,[e("div",null,[e("h1",il,k(((y=v(u))==null?void 0:y.name)||"Workshop"),1),e("p",al,k((a=v(u))!=null&&a.arcade?"Arcade":"Simulation"),1)]),e("div",rl,[x(tl,{id_workshop:v(s).params.id_workshop},null,8,["id_workshop"])])])]),e("div",cl,[e("div",dl,[(n(!0),d(A,null,T(v(_),g=>(n(),F(Re,{key:g.slug,location:g.slug,locationName:g.name,fleet:g.fleet,statTotals:g.statTotals,onSelect:m,onFlagship:b},null,8,["location","locationName","fleet","statTotals"]))),128))])])])]}),_:1})}}},hl=D(ul,[["__scopeId","data-v-d34a9c92"]]),_l=[{path:"/",component:vo,name:"builder.fleets"},{path:"/workshop/:id_workshop",component:hl,name:"builder.workshop"}],pl=Ae({history:Ie("/builder"),routes:_l}),N=We(Be),ml=Me();N.use(ml);N.component("VSelect",Le);N.component("ConfirmModal",Js);N.use(pl);N.use(qe);N.directive("tooltip",je);N.use(De,{position:Ve.TOP_RIGHT,timeout:3e3});N.mount("#app");Ee();

import{u as fe,M as me,o as l,f as c,e as b,a as e,t as S,n as U,d as Y,N as P,_ as q,O as be,r as ne,c as L,w as z,b as k,Q as ee,m as H,F as M,z as V,R as Ae,g as F,x as j,S as we,T as ke,U as re,V as de,D as x,W as te,X as ue,Y as oe,Z as K,$ as Te,a0 as _e,a1 as Ce,a2 as Ee,a3 as Ie,a4 as Fe,a5 as Le,a6 as Me,a7 as Ne,a8 as Be,a9 as ge,k as B,aa as I,ab as D,ac as se,ad as ie,ae as Ue,af as ze,ag as Oe,j as he,ah as Pe,ai as Re,aj as Ve,ak as pe,al as J,q as De,am as Ye,an as je}from"./AbilityItem-bfb7c390.js";const qe={key:0,class:"bg-indigo-900 text-indigo-200 px-3 py-1 md:flex gap-x-2"},We={class:""},He=e("div",{class:"ml-auto"},[e("a",{href:"/dashboard",class:"text-indigo-100 hover:text-white"}," Admin panel ")],-1),Ge={__name:"UserLayout",setup(t){const s=fe();return me(()=>{s.user||s.refresh()}),(i,a)=>(l(),c("div",{class:P(["layout layout--user",{"has-admin-bar":b(s).isAdmin}])},[b(s).isAdmin?(l(),c("div",qe,[e("div",We," Welcome, "+S(b(s).user.name)+". Hail, o' great admin! ",1),He])):U("",!0),Y(i.$slots,"default")],2))}};const Qe={class:"content-box p-3"},Ke=be('<div class="content-box__top flex" data-v-2cc5bd04><div class="shrink" data-v-2cc5bd04><div class="content-box__tick modal__tick" data-v-2cc5bd04></div></div><div class="grow" data-v-2cc5bd04></div><div class="shrink" data-v-2cc5bd04><div class="content-box__tick modal__tick" data-v-2cc5bd04></div></div></div>',1),Xe=be('<div class="content-box__bottom flex" data-v-2cc5bd04><div class="shrink" data-v-2cc5bd04><div class="content-box__tick modal__tick" data-v-2cc5bd04></div></div><div class="grow" data-v-2cc5bd04></div><div class="shrink" data-v-2cc5bd04><div class="content-box__tick modal__tick" data-v-2cc5bd04></div></div></div>',1),Ze={__name:"ContentBox",props:{bgClass:{type:String,default:"bg-modal-content/25"}},setup(t){return(s,i)=>(l(),c("div",Qe,[Ke,e("div",{class:P(["content-box__body modal-border py-3 px-3 text-modal-text m-4",[t.bgClass]])},[Y(s.$slots,"default",{},void 0,!0)],2),Xe]))}},ye=q(Ze,[["__scopeId","data-v-2cc5bd04"]]);const Je={class:"view view space-bg"},et={__name:"BuilderLayout",setup(t){return(s,i)=>{const a=ne("modals-container");return l(),L(Ge,{class:"themed"},{default:z(()=>[e("div",Je,[Y(s.$slots,"default",{},void 0,!0)]),k(a)]),_:3})}}},ea=q(et,[["__scopeId","data-v-4a8b88db"]]),tt={viewBox:"0 0 448 512",width:"1.2em",height:"1.2em"},st=e("path",{fill:"currentColor",d:"M400 256H152V152.9c0-39.6 31.7-72.5 71.3-72.9c40-.4 72.7 32.1 72.7 72v16c0 13.3 10.7 24 24 24h32c13.3 0 24-10.7 24-24v-16C376 68 307.5-.3 223.5 0C139.5.3 72 69.5 72 153.5V256H48c-26.5 0-48 21.5-48 48v160c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V304c0-26.5-21.5-48-48-48zM264 408c0 22.1-17.9 40-40 40s-40-17.9-40-40v-48c0-22.1 17.9-40 40-40s40 17.9 40 40v48z"},null,-1),it=[st];function at(t,s){return l(),c("svg",tt,it)}const lt={name:"fa-solid-unlock-alt",render:at},nt={viewBox:"0 0 640 512",width:"1.2em",height:"1.2em"},ot=e("path",{fill:"currentColor",d:"M544 160v64h32v64h-32v64H64V160h480m16-64H48c-26.51 0-48 21.49-48 48v224c0 26.51 21.49 48 48 48h512c26.51 0 48-21.49 48-48v-16h8c13.255 0 24-10.745 24-24V184c0-13.255-10.745-24-24-24h-8v-16c0-26.51-21.49-48-48-48zm-144 96H96v128h320V192z"},null,-1),ct=[ot];function rt(t,s){return l(),c("svg",nt,ct)}const dt={name:"fa-solid-battery-three-quarters",render:rt};const ut={__name:"Chips",props:{total:{type:Number,required:!0},chipLevel:{type:Number,required:!0},height:{type:String,default:"12px"}},setup(t){return(s,i)=>{const a=ee("tooltip");return H((l(),c("div",{class:"chips flex gap-x-[2px] cursor-pointer",style:Ae({"--height":t.height})},[(l(!0),c(M,null,V(t.total,o=>(l(),c("div",{class:P(["chip",{"chip--unlocked":o<=t.chipLevel}]),key:o},null,2))),128))],4)),[[a,"Chip level: "+t.chipLevel]])}}},_t=q(ut,[["__scopeId","data-v-5a957f65"]]),ht={class:"ship-fleet-item item"},pt={class:"ship-box__content"},vt={class:"ship-box__content-bg p-2"},ft={class:"flex w-full gap-x-3"},mt={class:"flex gap-x-2 text-xs items-center"},bt={class:"flex gap-x-[2px] items-center"},gt={class:"flex gap-x-2 items-center font-medium leading-none"},yt={class:"italic text-xs"},xt=e("div",null,null,-1),$t={class:"item__actions ml-auto"},St={__name:"ShipFleetLine",props:{userShip:{type:Object,required:!0}},setup(t){return(s,i)=>(l(),c("div",ht,[e("div",{class:P(["ship ship-box",["ship-box--"+t.userShip.ship.ship_level.name.toLowerCase()]])},[e("div",pt,[e("div",vt,[e("div",ft,[e("div",null,[e("div",mt,[e("div",null,S(t.userShip.ship.ship_class.name),1),e("div",bt,[e("div",null,[k(b(dt))]),e("div",null,S(t.userShip.ship.energy),1)]),e("div",null,[k(_t,{total:t.userShip.ship.chipCount,chipLevel:t.userShip.chip_level,height:"8px"},null,8,["total","chipLevel"])])]),e("div",gt,[e("div",null,S(t.userShip.ship.name),1),e("div",yt,S(t.userShip.name),1)])]),xt,e("div",$t,[Y(s.$slots,"actions")])]),Y(s.$slots,"footer")])])],2)]))}},At={key:0,class:"fleet__top-stats flex gap-x-2 justify-between items-center mb-4 leading-none"},wt={class:"fleet__leadership"},kt=e("div",{class:"text-xs text-text-blue"},"Leadership",-1),Tt={class:"text-center"},Ct={class:"fleet__ship-count"},Et=e("div",{class:"text-center text-xs text-text-blue"},"Ships",-1),It={class:"text-center"},Ft={__name:"FleetShipStats",props:{fleet:{type:Object,required:!0}},setup(t){return(s,i)=>{const a=ee("tooltip");return t.fleet.stats?(l(),c("div",At,[e("div",wt,[kt,e("div",Tt,[e("span",null,[e("b",null,S(t.fleet.stats.leadershipUsed),1)]),F(" / "),e("span",null,[e("b",null,S(t.fleet.leadership),1)]),t.fleet.stats.leadershipRemaining!==0?H((l(),c("span",{key:0,class:P(["font-bold cursor-pointer",{"text-grow-green-text-alt":t.fleet.stats.leadershipRemaining>0,"text-btn-red-border":t.fleet.stats.leadershipRemaining<0}])},[F(" ("+S(t.fleet.stats.leadershipRemaining>0?"+":"")+S(t.fleet.stats.leadershipRemaining)+") ",1)],2)),[[a,t.fleet.stats.leadershipRemaining>0?"Leader remaining":"Leadership exceeded"]]):U("",!0)])]),e("div",Ct,[Et,e("div",It,[e("b",null,S(t.fleet.stats.shipCount)+" / 9 ",1)])])])):U("",!0)}}},Lt={viewBox:"0 0 512 512",width:"1.2em",height:"1.2em"},Mt=e("path",{fill:"currentColor",d:"M349.565 98.783C295.978 98.783 251.721 64 184.348 64c-24.955 0-47.309 4.384-68.045 12.013a55.947 55.947 0 0 0 3.586-23.562C118.117 24.015 94.806 1.206 66.338.048C34.345-1.254 8 24.296 8 56c0 19.026 9.497 35.825 24 45.945V488c0 13.255 10.745 24 24 24h16c13.255 0 24-10.745 24-24v-94.4c28.311-12.064 63.582-22.122 114.435-22.122c53.588 0 97.844 34.783 165.217 34.783c48.169 0 86.667-16.294 122.505-40.858C506.84 359.452 512 349.571 512 339.045v-243.1c0-23.393-24.269-38.87-45.485-29.016c-34.338 15.948-76.454 31.854-116.95 31.854z"},null,-1),Nt=[Mt];function Bt(t,s){return l(),c("svg",Lt,Nt)}const le={name:"fa-solid-flag",render:Bt},Ut={viewBox:"0 0 512 512",width:"1.2em",height:"1.2em"},zt=e("path",{fill:"currentColor",d:"M416 48v416c0 26.51-21.49 48-48 48H144c-26.51 0-48-21.49-48-48V48c0-26.51 21.49-48 48-48h224c26.51 0 48 21.49 48 48zm96 58v12a6 6 0 0 1-6 6h-18v6a6 6 0 0 1-6 6h-42V88h42a6 6 0 0 1 6 6v6h18a6 6 0 0 1 6 6zm0 96v12a6 6 0 0 1-6 6h-18v6a6 6 0 0 1-6 6h-42v-48h42a6 6 0 0 1 6 6v6h18a6 6 0 0 1 6 6zm0 96v12a6 6 0 0 1-6 6h-18v6a6 6 0 0 1-6 6h-42v-48h42a6 6 0 0 1 6 6v6h18a6 6 0 0 1 6 6zm0 96v12a6 6 0 0 1-6 6h-18v6a6 6 0 0 1-6 6h-42v-48h42a6 6 0 0 1 6 6v6h18a6 6 0 0 1 6 6zM30 376h42v48H30a6 6 0 0 1-6-6v-6H6a6 6 0 0 1-6-6v-12a6 6 0 0 1 6-6h18v-6a6 6 0 0 1 6-6zm0-96h42v48H30a6 6 0 0 1-6-6v-6H6a6 6 0 0 1-6-6v-12a6 6 0 0 1 6-6h18v-6a6 6 0 0 1 6-6zm0-96h42v48H30a6 6 0 0 1-6-6v-6H6a6 6 0 0 1-6-6v-12a6 6 0 0 1 6-6h18v-6a6 6 0 0 1 6-6zm0-96h42v48H30a6 6 0 0 1-6-6v-6H6a6 6 0 0 1-6-6v-12a6 6 0 0 1 6-6h18v-6a6 6 0 0 1 6-6z"},null,-1),Ot=[zt];function Pt(t,s){return l(),c("svg",Ut,Ot)}const Rt={name:"fa-solid-microchip",render:Pt},Vt={viewBox:"0 0 512 512",width:"1.2em",height:"1.2em"},Dt=e("path",{fill:"currentColor",d:"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46s46-20.595 46-46s-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},null,-1),Yt=[Dt];function jt(t,s){return l(),c("svg",Vt,Yt)}const qt={name:"fa-solid-exclamation-circle",render:jt},Wt={viewBox:"0 0 512 512",width:"1.2em",height:"1.2em"},Ht=e("path",{fill:"currentColor",d:"M504 256c0 137-111 248-248 248S8 393 8 256S119 8 256 8s248 111 248 248zM273 369.9l135.5-135.5c9.4-9.4 9.4-24.6 0-33.9l-17-17c-9.4-9.4-24.6-9.4-33.9 0L256 285.1L154.4 183.5c-9.4-9.4-24.6-9.4-33.9 0l-17 17c-9.4 9.4-9.4 24.6 0 33.9L239 369.9c9.4 9.4 24.6 9.4 34 0z"},null,-1),Gt=[Ht];function Qt(t,s){return l(),c("svg",Wt,Gt)}const Kt={name:"fa-solid-chevron-circle-down",render:Qt},Xt={viewBox:"0 0 448 512",width:"1.2em",height:"1.2em"},Zt=e("path",{fill:"currentColor",d:"M352 320c-22.608 0-43.387 7.819-59.79 20.895l-102.486-64.054a96.551 96.551 0 0 0 0-41.683l102.486-64.054C308.613 184.181 329.392 192 352 192c53.019 0 96-42.981 96-96S405.019 0 352 0s-96 42.981-96 96c0 7.158.79 14.13 2.276 20.841L155.79 180.895C139.387 167.819 118.608 160 96 160c-53.019 0-96 42.981-96 96s42.981 96 96 96c22.608 0 43.387-7.819 59.79-20.895l102.486 64.054A96.301 96.301 0 0 0 256 416c0 53.019 42.981 96 96 96s96-42.981 96-96s-42.981-96-96-96z"},null,-1),Jt=[Zt];function es(t,s){return l(),c("svg",Xt,Jt)}const ts={name:"fa-solid-share-alt",render:es};const ss={class:"ability-tag__icon cursor-pointer"},is={class:"ability-tag__text"},as={class:"ability-tag__text__name"},ls={class:"ability-tag__badges flex gap-x-[2px] text-xs"},ns={key:0,class:"cursor-pointer"},os={key:1,class:"cursor-pointer"},cs={key:2,class:"ability-tag__boost cursor-pointer"},rs={__name:"AbilityTag",props:{parsedAbility:{type:Object,required:!0}},setup(t){const s=t,i=j(()=>s.parsedAbility.ability.location.includes("flagship_")?le:s.parsedAbility.ability.location.includes("chip_")?Rt:Kt);return(a,o)=>{const d=ee("tooltip");return l(),c("div",{class:P(["ability-tag flex gap-x-[3px] items-center text-xs leading-none",[`ability-tag--${t.parsedAbility.extra.affectType}`]])},[H((l(),c("div",ss,[(l(),L(we(b(i))))])),[[d,t.parsedAbility.extra.fullDescription]]),e("div",is,[e("div",as,[F(S(t.parsedAbility.extra.abilityTypeCategory)+" ",1),t.parsedAbility.extra.amountIsFormula?(l(),c(M,{key:0},[F(" calc(x) ")],64)):(l(),c(M,{key:1},[F(S(t.parsedAbility.extra.amount),1)],64))])]),e("div",ls,[t.parsedAbility.extra.hasConditions?H((l(),c("div",ns,[k(b(qt))])),[[d,`Condition: ${t.parsedAbility.extra.conditionsDescription}`]]):U("",!0),t.parsedAbility.extra.hasQualifiers?H((l(),c("div",os,[k(b(ke))])),[[d,t.parsedAbility.extra.abilityQualifiiers]]):U("",!0),t.parsedAbility.ability.applies_to_fleet&&!t.parsedAbility.ability.location.includes("flagship_")?H((l(),c("div",cs,[k(b(ts))])),[[d,"Boosts Fleet"]]):U("",!0)])],2)}}},xe=q(rs,[["__scopeId","data-v-3cc3fe04"]]),ds={viewBox:"0 0 512 512",width:"1.2em",height:"1.2em"},us=e("path",{fill:"currentColor",d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256S119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"},null,-1),_s=[us];function hs(t,s){return l(),c("svg",ds,_s)}const ps={name:"fa-solid-check-circle",render:hs},vs={viewBox:"0 0 512 512",width:"1.2em",height:"1.2em"},fs=e("path",{fill:"currentColor",d:"M256 8C119 8 8 119 8 256s111 248 248 248s248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65l-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7l65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"},null,-1),ms=[fs];function bs(t,s){return l(),c("svg",vs,ms)}const gs={name:"fa-solid-times-circle",render:bs},ys={class:"flex items-center gap-x-3"},xs={class:"ability__from flex gap-x-2 items-start"},$s={class:"shrink"},Ss={class:"text-sm italic pl-2"},As={class:"grow"},ws={class:"ability__matches"},ks={class:"flex gap-x-3 items-start"},Ts=e("div",{class:"text-xs text-modal-text"},"Applies to:",-1),Cs={key:1,class:"flex flex-wrap gap-2"},Es={class:"pl-2 text-white italic text-xs"},Is={key:2},Fs={__name:"FleetParsedAbilityLine",props:{fleetUserShips:{type:Array,required:!0},parsedFleetAbility:{type:Object,required:!0}},setup(t){const s=t,i=j(()=>s.parsedFleetAbility.hasConditions?s.parsedFleetAbility.meetsConditions:!0),a=j(()=>{const o=s.parsedFleetAbility,d=[];return s.fleetUserShips.forEach(n=>{let v=!0;o.hasQualifiers&&o.ability.for_class_ids.length&&(v=o.ability.for_class_ids.includes(n.ship.ship_class.id_class)),v&&d.push({id_user_ship:n.id_user_ship,id_ship:n.ship.id_ship,name:n.ship.name,nickname:n.name,ship_class:n.ship.ship_class.name})}),d});return(o,d)=>(l(),c("div",{class:P(["fleet-ability-line ability",{"ability--applied":b(i)}])},[e("div",ys,[e("div",null,[b(i)?(l(),L(b(ps),{key:0,class:"text-grow-green-text-alt"})):(l(),L(b(gs),{key:1,class:"text-btn-red-border"}))]),e("div",null,[e("div",xs,[e("div",$s,[F(S(t.parsedFleetAbility.source.name)+" ",1),e("div",Ss,S(t.parsedFleetAbility.source.nickname),1)]),e("div",As,[k(xe,{parsedAbility:t.parsedFleetAbility},null,8,["parsedAbility"])])]),e("div",ws,[e("div",ks,[Ts,e("div",null,[b(a).length===t.fleetUserShips.length?(l(),c(M,{key:0},[F(" All ships in fleet ")],64)):b(a).length?(l(),c("div",Cs,[(l(!0),c(M,null,V(b(a),(n,v)=>(l(),c("div",{key:`${n.id_user_ship}-${v}`},[F(S(n.name)+" ",1),e("span",Es,S(n.nickname),1)]))),128))])):(l(),c("div",Is,"Applies to no ships"))])])])])])],2))}},Ls={class:"fleet-ability-lines flex flex-col gap-y-3"},Ms={__name:"FleetParsedAbilityStats",props:{fleet:{type:Object,required:!0},parsedAbilities:{type:Object,required:!0}},setup(t){return(s,i)=>(l(),c("div",Ls,[(l(!0),c(M,null,V(t.parsedAbilities,a=>(l(),L(Fs,{parsedFleetAbility:a,fleetUserShips:t.fleet.user_ships,key:a.ability.id_ability},null,8,["parsedFleetAbility","fleetUserShips"]))),128))]))}},Ns={viewBox:"0 0 320 512",width:"1.2em",height:"1.2em"},Bs=e("path",{fill:"currentColor",d:"M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"},null,-1),Us=[Bs];function zs(t,s){return l(),c("svg",Ns,Us)}const Os={name:"fa-solid-caret-down",render:zs};const Ps={class:"accordion__header mb-2"},Rs={class:"ml-auto"},Vs={key:0,class:"accordion__body p-4"},Ds={__name:"Accordion",props:{name:{type:String,required:!0},modelValue:{type:String,default:"",required:!0}},emits:["update:modelValue"],setup(t,{emit:s}){const i=t,a=()=>{s("update:modelValue",i.name)},o=()=>{s("update:modelValue","")},d=()=>{n.value?o():a()},n=j(()=>i.modelValue===i.name);return(v,_)=>(l(),c("div",{class:P(["accordion mb-4",{"accordion--open":b(n)}])},[e("div",Ps,[Y(v.$slots,"header",re(de({toggle:d,open:a,close:o,isOpen:b(n)})),()=>[e("div",{class:"flex w-full py-2 px-4 border border-dark-border-start rounded cursor-pointer text-text-blue accordion__toggle",onClick:d},[e("div",null,[Y(v.$slots,"title",{},()=>[F(" Title here ")],!0)]),e("div",Rs,[k(b(Os),{class:P({"rotate-90":!b(n)})},null,8,["class"])])])],!0)]),b(n)?(l(),c("div",Vs,[e("div",null,[Y(v.$slots,"body",re(de({toggle:d,open:a,close:o,isOpen:b(n)})),void 0,!0)])])):U("",!0)],2))}},ve=q(Ds,[["__scopeId","data-v-9fcaaa54"]]),Ys=(t,s)=>{let i=!0;return t.ability.for_class_ids.length&&(i=t.ability.for_class_ids.includes(s.ship.ship_class.id_class)),i&&!t.meetsConditions&&(i=!1),i},js=t=>{const s=t.ability,i=[];s.duration_type&&i.push(`duration--${s.duration_type}-${s.duration}`),s.repeat_type&&i.push(`repeat--${s.repeat_type}-${s.repeat}`),s.variants.length&&i.push(["variant",[...s.variants]]),s.for_class_ids.length&&i.push(["for_class",[...s.for_class_ids]]),s.target_class_ids.length&&i.push(["target_class",[...s.target_class_ids]]),s.weapon_classes.length&&i.push(["weapon_class",[...s.weapon_classes]]),s.weapon_sizes.length&&i.push(["weapon_size",[...s.weapon_sizes]]);const a=(o,d)=>{if(!d.length)return o;const n=d.shift();if(Array.isArray(n)){const[v,_]=n;o.length?o=o.reduce((h,f)=>(_.forEach(y=>{h.push(f+"|"+v+"--"+y)}),h),[]):_.forEach(h=>{o.push(v+"--"+h)})}else typeof n=="string"&&(o.length?o=o.map(v=>v+"|"+n):o.push(n));return a(o,d)};return a([],i.length?i:["all"])},qs=(t,s)=>{if(t.ability.type===x.ABILITY_TYPES.INCREASE_WEAPON_DAMAGE){let i=s.ship.slotStrengths.weapon.total;return t.ability.weapon_sizes.length&&(i=t.ability.weapon_sizes.reduce((a,o)=>a+s.ship.slotStrengths.weapon[o],0)),i}else if(t.ability_type===x.ABILITY_TYPES.REDUCE_DAMAGE&&(!t.ability.variants.length||t.ability.variants.includes(x.RESISTANCE_TYPES.ARMOR)))return s.ship.slotStrengths.armor.total;return 1},Ws=(t,s,i,a)=>{const o=t.ability;let d=[],n=[],v=[];if(o.target_class_ids.length){const[,_]=a.match(/target_class--(\d+)/);d=[parseInt(_)]}if(o.for_class_ids.length){const[,_]=a.match(/for_class--(\d+)/);v=[parseInt(_)]}if(o.variants.length){const[,_]=a.match(/variant--([a-z]+)/);n=[isNaN(parseInt(_))?_:parseInt(_)]}return{source:{ability:t.ability,amount:i,id_user_ship:t.userShip.id_user_ship,slug:a},target:{id_user_ship:s.id_user_ship},strength:qs(t,s),variants:n,target_class_ids:d,for_class_ids:v}},ae=(t,s,i)=>{const a=s.split("."),o=a.pop();let d=t;a.forEach(n=>{d[n]||(d[n]={}),d=d[n]}),d[o]||(d[o]=i)},Hs=(t,s,i,a,o,d)=>{const n=t.ability,v=[x.AMOUNT_TYPES.NUMBER,x.AMOUNT_TYPES.PERCENT,x.AMOUNT_TYPES.SECONDS,x.AMOUNT_TYPES.ATTACKS];n.amounts.forEach(_=>{ae(a,`${n.type}.${i}.${_.type}`,[]),ae(o,`${s.id_user_ship}.${n.type}.${i}.${_.type}`,[]),ae(d,`${n.id_ability}.${i}.${_.type}`);const h=Ws(t,s,_,i);v.includes(_.type)?(h.value=parseFloat(_.value),a[n.type][i][_.type].push(h),o[s.id_user_ship][n.type][i][_.type].push(h),d[n.id_ability][i][_.type]=h):_.type===x.AMOUNT_TYPES.FORMULA?(h.value=_,a[n.type][i][_.type].push(h),o[s.id_user_ship][n.type][i][_.type].push(h),d[n.id_ability][i][_.type]=h):console.warn("Unknown amount type",_.type,_)})},Gs=t=>{const s={},i={},a={};return t.parsedAbilities.forEach(o=>{t.user_ships.forEach(d=>{if(!Ys(o,d))return!1;js(o).forEach(_=>{Hs(o,d,_,s,i,a)})})}),{shipStats:i,totalStats:s,abilityStats:a}},Qs=t=>t.reduce((s,i)=>{const{totalStats:a,shipStats:o,abilityStats:d}=Gs(i);return s[i.id_workshop_fleet]={totalStats:a,shipStats:o,abilityStats:d},s},{}),Ks=(t,s)=>{const i=x.getVariantsByAbilityType(),a=[];return Object.entries(s).forEach(([o,d])=>{Object.entries(d).forEach(([n,v])=>{Object.entries(v).forEach(([_,h])=>{if(!(h&&h.length))return console.log("no arr",o,n,_,h);const f=h.shift(),y=[f.target.id_user_ship],N=[f.source.ability.id_ability];h.forEach(T=>{y.includes(T.target.id_user_ship)||y.push(T.target.id_user_ship),N.includes(T.source.ability.id_ability)||N.push(T.source.ability.id_ability)}),f.isVariantType=!!i[o],f.target=y,f.amountType=_,f.abilityType=o,f.slug=n,[x.AMOUNT_TYPES.NUMBER,x.AMOUNT_TYPES.PERCENT,x.AMOUNT_TYPES.SECONDS,x.AMOUNT_TYPES.ATTACKS].includes(_)?(h.forEach(T=>{f.value+=T.value,f.strength+=T.strength}),f.value/=y.length,f.strength/=N.length):_===x.AMOUNT_TYPES.FORMULA&&(f.values=[f.value],h.forEach(T=>{f.values.push(T.value)})),a.push(f)})})}),a},Xs=x.getAbilityTypes(),Zs=(t,s,{shipClasses:i})=>{const a=s.source.ability,o=Xs.find(O=>O.slug===a.type).name,d={default:"{abilityName}",[x.ABILITY_TYPES.INCREASE_WEAPON_DAMAGE]:"Increase {variants} Weapon Damage",[x.ABILITY_TYPES.REDUCE_DAMAGE]:"Reduce {variants} Damage",[x.ABILITY_TYPES.INCREASE_RESISTENCE]:"Increase {variants} Resistance",[x.ABILITY_TYPES.INCREASE_PENETRATION]:"Increase {variants} Penetration"};let n;if(s.isVariantType){const O=a.variants.length?te(s.variants.map(ue.singular).map(oe.upperFirst)):"All";n=K(d[a.type],{abilityName:o,variants:O})}else n=K(d.default,{abilityName:o});const v=a.for_class_ids.length?`${s.target.length} `+te(Te(s.for_class_ids,{shipClasses:i})):ue("ship",s.target.length,!0),_=K("of {ships}",{ships:v}),h={default:"by {parsedAmount}",[x.ABILITY_TYPES.INCREASE_ATTACK_SPEED]:"by {parsedAmount}",[x.ABILITY_TYPES.EXTRA_ATTACK]:"does {parsedAmount} damage"};let f;s.amountType===x.AMOUNT_TYPES.FORMULA?f=te(s.values.map(O=>_e(a,O))):f=_e(a,{type:s.amountType,value:Ce(s.value)});const y=K(h[s.amountType]||h.default,{parsedAmount:f});let N="";s.strength>s.target.length&&(N=K("(affecting {strength} strength)",{strength:s.strength}));let T="";a.target_class_ids.length&&(T=Ee({...a,target_class_ids:s.target_class_ids},{shipClasses:i}));const G=Ie(a),Q=Fe(a),w=K("{title} {shipCount} {amount} {strength} {against} {duration} {repeat}",{title:n,shipCount:_,amount:y,strength:N,against:T,duration:G,repeat:Q}).replace(/\s{2,}/gm," ").trim(),C=Le(a),R=Me(a),$=Ne(a);return{description:w,category:C,affectType:R,affectTypeName:$}},Js=Be("builder",()=>{const t=ge(),s=B([]),i=B(!1),a=B([]),o=B([]),d=B(!1),n=B([]),v=B(!1),_=B(null),h=B([]),f=u=>(y(u.ship),Ue(u,{shipClasses:D(a.value)}),u),y=u=>(ze(u),u.chipCount=Oe(u),u),N=u=>{_.value=u,h.value=[],ce(u)},T=j(()=>h.value.reduce((u,p)=>(u[p.id_workshop_fleet]=p.parsedAbilities,u),{})),G=j(()=>Qs(h.value)),Q=async()=>{i.value=!0,await I.get("data/ships").then(u=>u.data.rows.map(y)).then(u=>{s.value=u}),i.value=!1},X=async()=>I.get("data/ships/classes").then(u=>{a.value=u.data.rows}),w=async()=>{d.value=!0,await I.get("user/ships").then(u=>u.data.rows.map(f)).then(u=>{o.value=u}),d.value=!1},C=async()=>{v.value=!0,await I.get("user/workshops").then(u=>{n.value=u.data.rows.map(p=>({...p}))}),v.value=!1},R=async u=>{var p,g;try{const r=await I.post("user/ships",u),m=o.value,A=r.data.row;if(f(A),u.id_user_ship){const E=m.findIndex(Se=>Se.id_user_ship===u.id_user_ship);m.splice(E,1,A)}else m.push(A);return!0}catch(r){return t.error("Error saving ship: "+(((g=(p=r.response)==null?void 0:p.data)==null?void 0:g.message)||r.message)),!1}},$=async u=>{var p,g;try{await I.delete("user/ships/"+u);const r=[...o.value].map(A=>D(A)),m=r.findIndex(A=>A.id_user_ship===u);return r.splice(m,1),o.value=r,!0}catch(r){return t.error("Error deleting ship: "+(((g=(p=r.response)==null?void 0:p.data)==null?void 0:g.message)||r.message)),!1}},O=async u=>{var p,g;try{const r=await I.post("user/workshops",u);return n.value.push(r.data.row),r.data.row}catch(r){return t.error("Error creating workshop: "+(((g=(p=r.response)==null?void 0:p.data)==null?void 0:g.message)||r.message)),!1}},$e=async u=>{var p,g;try{await I.delete(`user/workshops/${u}`);const r=[...n.value].map(A=>D(A)),m=r.findIndex(A=>A.id_workshop===u);return r.splice(m,1),n.value=r,!0}catch(r){return t.error("Error deleting workshop: "+(((g=(p=r.response)==null?void 0:p.data)==null?void 0:g.message)||r.message)),!1}},ce=async u=>{const p=await I.get(`user/workshops/${u}/fleets`).then(g=>g.data.rows.map(r=>(r.user_ships=r.user_ships.filter(m=>m.visible),r)));Z(p)},Z=u=>{h.value=u.map(p=>(p.user_ships=p.user_ships.map(g=>({...oe.cloneDeep(D(o.value.find(m=>m.id_user_ship===g.id_user_ship))),pivot:g.pivot})),p.stats=se(p),p.parsedAbilities=ie(p),p))};return{userShips:o,isLoadingUserShips:d,isLoadingShips:i,ships:s,shipClasses:a,workshops:n,isLoadingWorkshops:v,selectedFleets:h,selectedFleetsAbilityLists:T,selectedFleetsStats:G,loadShips:Q,loadShipClasses:X,loadUserShips:w,loadWorkshops:C,createWorkshop:O,deleteUserShip:$,createOrUpdateUserShip:R,deleteWorkshop:$e,loadWorkshopFleets:ce,createOrUpdateFleet:async(u,p,g)=>I.post(`user/workshops/${u}/fleets`,{...g,location:p}).then(r=>r.data.row).then(r=>{const m=h.value;if(g.id_workshop_fleet){const A=m.findIndex(E=>E.id_workshop_fleet===g.id_workshop_fleet);m.splice(A,1,r)}else m.push(r);return Z(m),r}),deleteFleet:async(u,p)=>I.delete(`user/workshops/${u}/fleets/${p}`).then(()=>{const g=h.value.findIndex(m=>m.id_workshop_fleet===parseInt(p)),r=h.value;r.splice(g,1),Z(r)}),addUserShipToFleet:(u,p,g)=>I.post(`user/workshops/${u}/fleets/${p}/ships`,{id_user_ship:g}).then(r=>r.data.row).then(r=>{const m=h.value.findIndex(E=>E.id_workshop_fleet===parseInt(p)),A=h.value;A.splice(m,1,r),Z(A)}),removeUserShipFromFleet:(u,p,g)=>I.delete(`user/workshops/${u}/fleets/${p}/ships/${g}`).then(r=>r.data.row).then(r=>{const m=h.value.findIndex(E=>E.id_workshop_fleet===parseInt(p)),A=h.value;A.splice(m,1,r),Z(A)}),setFleetFlagship:(u,p,g)=>I.post(`user/workshops/${u}/fleets/${p}/flagship`,{id_user_ship:g}).then(r=>r.data.row).then(()=>{const r=h.value.findIndex(E=>E.id_workshop_fleet===parseInt(p)),m=h.value[r],A=[...m.user_ships].map(E=>D(E)).map(E=>({...E,pivot:{...E.pivot,flagship:E.id_user_ship===g}}));h.value[r].user_ships=A,h.value[r].stats=se(m),h.value[r].parsedAbilities=ie(m)}),setSelectedWorkshopId:N,loadSharedWorkshop:async u=>{const p=I.get("data/workshop/"+u).then(m=>m.data.row),g=X();await Promise.all([p,g]);const r=await p;n.value=[r],h.value=r.fleets.map(m=>(m.user_ships.map(f),m.stats=se(m),m.parsedAbilities=ie(m),m)),_.value=r.id_workshop}}});const ei={class:"fleet-ability-totals"},ti={key:0,class:"grid w-full gap-y-2"},si={class:"total-item__header font-bold text-sm text-modal-title mb-1"},ii={class:"total-item__description text-xs"},ai={__name:"FleetAbilityTotals",props:{fleet:{type:Object,required:!0},totals:{type:Object,required:!0}},setup(t){const s=t,i=Js(),a=j(()=>Ks(s.fleet,oe.cloneDeep(D(s.totals))).map(d=>({...d,...Zs(s.fleet,d,{shipClasses:i.shipClasses})})));return(o,d)=>{var n;return l(),c("div",ei,[(n=b(a))!=null&&n.length?(l(),c("div",ti,[(l(!0),c(M,null,V(b(a),(v,_)=>(l(),c("div",{class:P(["total-item border-l-4 pl-2 py-1",[`total-item--${v.affectType}`]]),key:v.slug+_},[e("div",si,S(v.category)+" > "+S(v.affectTypeName),1),e("div",ii,S(v.description),1)],2))),128))])):U("",!0)])}}},li=q(ai,[["__scopeId","data-v-9f09701a"]]);const ni={class:"fleet__info grow p-4 rounded min-h-[350px] mb-4 border border-dark-border-start"},oi={key:0,class:"fleet__used leading-none"},ci={class:"fleet__ships flex flex-col gap-y-2 mb-8"},ri=["onClick"],di={key:1,class:"ship-box__strengths flex gap-x-2 items-center"},ui={class:"ship-box__strengths-total text-center text-xs"},_i={class:"text-base font-medium text-grow-green-text-alt"},hi={class:"ship-box__strengths-total text-center text-xs"},pi={class:"text-base font-medium text-grow-green-text-alt"},vi={class:"ship-box__strengths-total text-center text-xs"},fi={class:"text-base font-medium text-grow-green-text-alt"},mi={key:0,class:"pt-2 flex flex-wrap gap-1"},bi={key:0,class:"fleet__basic-stats mb-4"},gi={key:1,class:"fleet__total-stats mb-4"},yi={key:1,class:"fleet__placeholder"},xi={class:"fleet__button"},$i={key:0,src:"/images/fleet-icon.png"},Si={class:"sleet-slot__label text-xs text-white"},Ai={__name:"FleetItem",props:{statTotals:{type:[Object,null],required:!0},location:{type:String,required:!0},locationName:{type:String,required:!0},fleet:{type:Object,default:null},isPublic:{type:Boolean,default:!1},withTags:{type:Boolean,default:!1}},emits:["select","flagship"],setup(t,{emit:s}){const i=t,a=B(""),o=()=>{s("select",{slug:i.location,name:i.locationName},i.fleet)},d=v=>{s("flagship",D(i.fleet),D(v))},n=j(()=>!i.fleet||!i.fleet.stats);return(v,_)=>{var f;const h=ee("tooltip");return l(),c("div",{class:P(["fleet flex flex-col h-full",{"fleet--busy":!b(n),"fleet--empty":b(n)}])},[e("div",ni,[b(n)?(l(),c("div",yi,"No Fleet Assigned")):(l(),c("div",oi,[k(Ft,{fleet:t.fleet},null,8,["fleet"]),e("div",ci,[(l(!0),c(M,null,V(t.fleet.user_ships,y=>(l(),L(St,{key:`${y.id_user_ship}-${y.pivot.flagship}`,userShip:y},{actions:z(()=>[t.isPublic?(l(),c("div",di,[e("div",ui,[F(" Weapons "),e("div",_i,S(y.ship.slotStrengths.weapon.total),1)]),e("div",hi,[F(" Armor "),e("div",pi,S(y.ship.slotStrengths.armor.total),1)]),e("div",vi,[F(" Units "),e("div",fi,S(y.ship.slotStrengths.unit.total),1)])])):(l(),c(M,{key:0},[y.pivot.flagship?H((l(),L(b(le),{key:0,class:"text-box-green"},null,512)),[[h,"Fleet Flagship"]]):(l(),c("button",{key:1,class:"btn btn-blue btn-sm",onClick:()=>d(y)},[F(" Set "),k(b(le))],8,ri))],64))]),footer:z(()=>[t.withTags?(l(),c("div",mi,[(l(!0),c(M,null,V(y.parsedAbilities,N=>(l(),L(xe,{key:N.ability.id_ability,parsedAbility:N},null,8,["parsedAbility"]))),128))])):U("",!0)]),_:2},1032,["userShip"]))),128))]),(f=t.fleet.user_ships)!=null&&f.length?(l(),c("div",bi,[k(ve,{name:"fleet-ability-stats",modelValue:a.value,"onUpdate:modelValue":_[0]||(_[0]=y=>a.value=y)},{title:z(()=>[F(" Stacked Fleet Abilities ")]),body:z(()=>[k(Ms,{fleet:t.fleet,parsedAbilities:t.fleet.parsedAbilities},null,8,["fleet","parsedAbilities"])]),_:1},8,["modelValue"])])):U("",!0),t.statTotals.totalStats?(l(),c("div",gi,[k(ve,{name:"fleet-ability-totals",modelValue:a.value,"onUpdate:modelValue":_[1]||(_[1]=y=>a.value=y)},{title:z(()=>[F(" Fleet Ability Totals ")]),body:z(()=>[k(li,{fleet:t.fleet,totals:t.statTotals.totalStats},null,8,["fleet","totals"])]),_:1},8,["modelValue"])])):U("",!0)]))]),e("div",{class:"fleet__bottom shrink flex flex-col items-center",onClick:o},[e("div",xi,[b(n)?(l(),L(b(lt),{key:1})):(l(),c("img",$i))]),e("div",Si,S(t.locationName),1)])],2)}}},ta=q(Ai,[["__scopeId","data-v-0bf422ad"]]);const wi=e("div",{class:"quick-reference"},[e("h2",{class:"text-2xl text-modal-title font-medium mb-10"}," Quick Reference Guide "),e("div",{class:"mb-6"},[e("h3",{class:"text-2xl text-modal-title font-medium mb-4"}," Strength by size "),e("p",{class:"mb-2"}," Armor, weapons and units have 3 sizes: Small, Medium, and Large. For calculatin total ship strength, we use the following weights: "),e("div",{class:"block"},[e("div",{class:"pl-2"},[e("div",null,"S: 1"),e("div",null,"M: 2"),e("div",null,"L: 4")])])]),e("div",{class:"mb-6"},[e("h3",{class:"text-2xl text-modal-title font-medium mb-4"}," Ship Strength "),e("p",{class:"mb-2"}," Each ship has weapon, armor and unit slots, either size Small, Medium or Large. Strength is a sum of those values, as applicable. "),e("div",{class:"block"},[e("div",null,"Example: Puck Frigate Weaon Strength"),e("div",{class:"pl-2"},[e("div",null,"S: 3"),e("div",null,"M: 2"),e("div",null,"L: 0"),e("div",null,"Total: 10")])])]),e("div",{class:"mb-6"},[e("h3",{class:"text-2xl text-modal-title font-medium mb-4"}," Fleet Totals: Affected Strength "),e("p",{class:"mb-2"}," This is the sum of affected ship weapon strength, filtered by applicable ships and weapon sizes. "),e("div",{class:"block"},[e("div",null,"Example: Antu'Valu L weapons + 63%"),e("div",{class:"pl-2"},[e("div",null,"1) Get all ships in fleet"),e("div",null,"2) Get L weapon strength of each ship"),e("div",null,"3) Sum the weapon strength")])])])],-1),ki={__name:"QuickGuideModal",props:{},setup(t){return(s,i)=>{const a=ne("vue-final-modal");return l(),L(a,{classes:"modal-container","content-class":"w-full modal-content--2xl"},{default:z(()=>[k(ye,{class:"w-full","bg-class":"custom-bg"},{default:z(()=>[wi]),_:1})]),_:1})}}};const W=t=>(Ye("data-v-c59b8c31"),t=t(),je(),t),Ti={class:"quick-reference"},Ci=W(()=>e("h2",{class:"text-2xl text-gray-800 font-medium mb-10"}," Submit Ship ",-1)),Ei={class:"mb-8"},Ii=W(()=>e("h3",{class:"font-medium text-xl mb-4"},"Basic Ship Info",-1)),Fi=W(()=>e("div",null,null,-1)),Li=W(()=>e("hr",null,null,-1)),Mi={class:"mb-8 mt-8"},Ni=W(()=>e("h3",{class:"font-2xl mb-4 font-medium text-xl"}," Ship Slots ",-1)),Bi={class:"slots grid gap-1"},Ui=W(()=>e("hr",null,null,-1)),zi={class:"my-8"},Oi=W(()=>e("h3",{class:"font-2xl mb-4 font-medium text-xl"}," Ship Abilities ",-1)),Pi={class:"abilities grid gap-1"},Ri={class:"my-8"},Vi=W(()=>e("h3",{class:"font-2xl mb-4 font-medium text-xl"}," Chip Abilities ",-1)),Di={class:"abilities grid gap-1"},Yi=["disabled"],ji={__name:"SubmitShipModal",props:{},setup(t){const s=x.getSizes(),i=x.getSlotTypes(),a=x.getShipAbilityLocations(),o=a.filter(w=>!w.isChip),d=a.filter(w=>w.isChip),n=ge(),v=he({id_class:"",id_level:"",name:"",energy:0,public:!1}),_=he({weapon:{s:0,m:0,l:0},armor:{s:0,m:0,l:0},unit:{s:0,m:0,l:0}}),h=B(!1),f=B({}),y=B(!1),N=(w,C)=>{Object.assign(v,w),y.value=!0,C(!1)},T=(w,C)=>{_[w]=C},G=(w,C)=>{f.value[w]||(f.value[w]=[]),f.value[w]=C,J.hide(`ability-modal-${w}`)},Q=(w,C,R)=>{f.value[C].splice(R,1)},X=async()=>{var C,R;h.value=!0;const w={form:{id_class:v.id_class,id_level:v.id_level,name:v.name,energy:v.energy},slots:_,abilities:f.value};try{const $=await De.post("data/ships",w);n.success("Ship submitted successfully. Thank you!"),J.hideAll()}catch($){console.warn("caught error submitting ship",$),n.error(((R=(C=$.response)==null?void 0:C.data)==null?void 0:R.message)||$.message)}h.value=!1};return(w,C)=>{const R=ne("vue-final-modal");return l(),L(R,{classes:"modal-container submit-ship-modal","content-class":"w-full modal-content--4xl"},{default:z(()=>[k(ye,{class:"w-full","bg-class":"custom-bg text-gray-600"},{default:z(()=>[e("div",Ti,[Ci,e("div",Ei,[Ii,k(Pe,{onSubmit:N,"is-admin":!1,disabled:y.value},Re({_:2},[y.value?{name:"button",fn:z(()=>[Fi]),key:"0"}:void 0]),1032,["disabled"])]),y.value?(l(),c(M,{key:0},[Li,e("div",Mi,[Ni,e("div",Bi,[(l(!0),c(M,null,V(b(i),$=>(l(),L(Ve,{key:$.slug,sizes:b(s),type:$.slug,onSave:T,label:`${$.name} Slots`},null,8,["sizes","type","label"]))),128))])]),Ui,e("div",zi,[Oi,e("div",Pi,[(l(!0),c(M,null,V(b(o),$=>(l(),L(pe,{key:$.slug,location:$.slug,"location-name":$.name,abilities:f.value[$.slug]||[],onSave:O=>G($.slug,O),onDelete:Q,stackable:!0},null,8,["location","location-name","abilities","onSave"]))),128))])]),e("div",Ri,[Vi,e("div",Di,[(l(!0),c(M,null,V(b(d),$=>(l(),L(pe,{key:$.slug,location:$.slug,"location-name":$.name,stackable:!0,abilities:f.value[$.slug]||[],onSave:O=>G($.slug,O),onDelete:Q},null,8,["location","location-name","abilities","onSave"]))),128))])]),e("div",null,[e("button",{class:"btn bg-sky-600 hover:bg-sky-800",onClick:X,disabled:h.value},S(h.value?"Submitting...":"Submit For Review"),9,Yi)])],64)):U("",!0)])]),_:1})]),_:1})}}},qi=q(ji,[["__scopeId","data-v-c59b8c31"]]),Wi={class:"workshop__help bg-dark-bg-start/75 p-6 flex gap-x-6 mb-6"},sa={__name:"HelpBar",props:{},setup(t){const s=fe(),i=()=>{console.log("trying to show"),J.show({component:ki})},a=()=>{J.show({component:qi})};return me(()=>{s.user||s.refresh()}),(o,d)=>(l(),c("div",Wi,[e("div",null,[e("button",{type:"button",class:"btn btn-blue",onClick:d[0]||(d[0]=n=>i())}," Quick Reference Guide ")]),e("div",null,[b(s).isTester?(l(),c("button",{key:0,type:"button",class:"btn btn-blue",onClick:a}," Missing a ship? ")):U("",!0)])]))}};export{xe as A,ea as B,ye as C,ta as F,dt as I,ts as S,Ge as _,sa as a,_t as b,Ft as c,Js as u};
